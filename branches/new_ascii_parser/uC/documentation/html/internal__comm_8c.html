<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>uC: internal_comm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>internal_comm.c File Reference</h1>The internal communication routines.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;avr/io.h&gt;</code><br>
<code>#include &lt;avr/interrupt.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &quot;<a class="el" href="internal__comm_8h-source.html">internal_comm.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="internal__comm__rx__queue_8h-source.html">internal_comm_rx_queue.h</a>&quot;</code><br>
<code>#include &quot;internal_comm_tx_queue.h&quot;</code><br>

<p>
<a href="internal__comm_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#038459fe5d58ddbde1ed8459d3b9bbce">internal_comm_init</a> (void(*func_ptr_rx)(<a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a>), void(*func_ptr_tx)(char))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the internal communication.  <a href="#038459fe5d58ddbde1ed8459d3b9bbce"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7db36f8f06871f98ad2effe0484aaacb"></a><!-- doxytag: member="internal_comm.c::internal_comm_reset_rx" ref="7db36f8f06871f98ad2effe0484aaacb" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#7db36f8f06871f98ad2effe0484aaacb">internal_comm_reset_rx</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Will reset the RX variables. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#64c4f318386e5cad700f6c5e08677c6f">internal_comm_poll_rx_queue</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Polls the RX queue in the internal communication and calls the function defined in internal_comm_init.  <a href="#64c4f318386e5cad700f6c5e08677c6f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#35f8e503f80c8e1188ad09c1c0dde6ec">internal_comm_poll_tx_queue</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Polls the TX queue in the internal communication and sends the data if there is a message in the queue.  <a href="#35f8e503f80c8e1188ad09c1c0dde6ec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="fbadb98b60aabeefe61ca1d21ec183db"></a><!-- doxytag: member="internal_comm.c::internal_comm_send_ack" ref="fbadb98b60aabeefe61ca1d21ec183db" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#fbadb98b60aabeefe61ca1d21ec183db">internal_comm_send_ack</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an ACK message to the internal communication uart. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="17a9a942903f42bd140b2cd0e2486161"></a><!-- doxytag: member="internal_comm.c::internal_comm_send_nack" ref="17a9a942903f42bd140b2cd0e2486161" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#17a9a942903f42bd140b2cd0e2486161">internal_comm_send_nack</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a NACK message to the internal communication uart. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#b19320006eb32811d9c211f41e229f87">internal_comm_send_message</a> (<a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a> tx_message)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a message to the internal communication uart.  <a href="#b19320006eb32811d9c211f41e229f87"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#d9191f782631f96ebe7a5d9d846ba97b">internal_comm_add_tx_message</a> (unsigned char command, unsigned char length, char *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a message to the transmit queue.  <a href="#d9191f782631f96ebe7a5d9d846ba97b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="37cb0731cb2b98770a5a67dfdd0303c6"></a><!-- doxytag: member="internal_comm.c::internal_comm_resend" ref="37cb0731cb2b98770a5a67dfdd0303c6" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#37cb0731cb2b98770a5a67dfdd0303c6">internal_comm_resend</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Will trigger a resend of the last message. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="116f51fef6fde319f24771be58a1cd3f"></a><!-- doxytag: member="internal_comm.c::ISR" ref="116f51fef6fde319f24771be58a1cd3f" args="(ISR_INTERNAL_COMM_USART_RECV)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#116f51fef6fde319f24771be58a1cd3f">ISR</a> (ISR_INTERNAL_COMM_USART_RECV)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interrupt when a byte has been received from the UART. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="967b3989f7a8a467a717d1d294007553"></a><!-- doxytag: member="internal_comm.c::ISR" ref="967b3989f7a8a467a717d1d294007553" args="(ISR_INTERNAL_COMM_USART_DATA)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#967b3989f7a8a467a717d1d294007553">ISR</a> (ISR_INTERNAL_COMM_USART_DATA)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interrupt when data has been received from the UART. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bfbe070c4b84a6b49bbf3db2a1d2e98d"></a><!-- doxytag: member="internal_comm.c::internal_comm_1ms_timer" ref="bfbe070c4b84a6b49bbf3db2a1d2e98d" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#bfbe070c4b84a6b49bbf3db2a1d2e98d">internal_comm_1ms_timer</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function which should be called each ms. <br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="108a8e4cf1a7729812b3afadcf424cdd"></a><!-- doxytag: member="internal_comm.c::uc_com" ref="108a8e4cf1a7729812b3afadcf424cdd" args="" -->
<a class="el" href="structstruct__uc__com.html">struct_uc_com</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#108a8e4cf1a7729812b3afadcf424cdd">uc_com</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The uc_com struct. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b37c2abb5a019cb9a3ba7cba1e4252e6"></a><!-- doxytag: member="internal_comm.c::uc_new_message" ref="b37c2abb5a019cb9a3ba7cba1e4252e6" args="" -->
<a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#b37c2abb5a019cb9a3ba7cba1e4252e6">uc_new_message</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Where we save any new uc_comm message. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5200fe8c22d2a9918f2ddef7b1f822bf"></a><!-- doxytag: member="internal_comm.c::prev_data" ref="5200fe8c22d2a9918f2ddef7b1f822bf" args="" -->
unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#5200fe8c22d2a9918f2ddef7b1f822bf">prev_data</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The previous data. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8df17071e5aaff4e53813ce271797b54"></a><!-- doxytag: member="internal_comm.c::counter_tx_timeout" ref="8df17071e5aaff4e53813ce271797b54" args="" -->
unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#8df17071e5aaff4e53813ce271797b54">counter_tx_timeout</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Counter which keep track of when we last did a transmission. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c42071d321700206caa2e1f2bb776d6f"></a><!-- doxytag: member="internal_comm.c::counter_rx_timeout" ref="c42071d321700206caa2e1f2bb776d6f" args="" -->
unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#c42071d321700206caa2e1f2bb776d6f">counter_rx_timeout</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Counter which keeps track of when we last did receive a character. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6fff055a880b6ab94f453a605e2dfea8"></a><!-- doxytag: member="internal_comm.c::resend_count" ref="6fff055a880b6ab94f453a605e2dfea8" args="" -->
unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#6fff055a880b6ab94f453a605e2dfea8">resend_count</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The number of times the last message has been resent. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="67735c2b4d72de4b89eabd354a79c111"></a><!-- doxytag: member="internal_comm.c::msg_not_acked" ref="67735c2b4d72de4b89eabd354a79c111" args="" -->
unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#67735c2b4d72de4b89eabd354a79c111">msg_not_acked</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flag that the message has yet not been acked. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1bb3b57523849b2a6507039940dc7495"></a><!-- doxytag: member="internal_comm.c::f_ptr_rx" ref="1bb3b57523849b2a6507039940dc7495" args=")(UC_MESSAGE)" -->
void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#1bb3b57523849b2a6507039940dc7495">f_ptr_rx</a> )(<a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function to be called when a message is recieved and should be parsed/executed. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="733ad7cf6722dfbf0c368f8e39a2cce7"></a><!-- doxytag: member="internal_comm.c::f_ptr_tx" ref="733ad7cf6722dfbf0c368f8e39a2cce7" args=")(char)" -->
void(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8c.html#733ad7cf6722dfbf0c368f8e39a2cce7">f_ptr_tx</a> )(char)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function to be called when we wish to send a message. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The internal communication routines. 
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Mikael Larsmark, SM2WMV </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-01-25 <div class="fragment"><pre class="fragment"><span class="preprocessor"> #include "<a class="code" href="internal__comm_8c.html" title="The internal communication routines.">internal_comm.c</a>"</span> 
</pre></div> </dd></dl>

<p>Definition in file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="d9191f782631f96ebe7a5d9d846ba97b"></a><!-- doxytag: member="internal_comm.c::internal_comm_add_tx_message" ref="d9191f782631f96ebe7a5d9d846ba97b" args="(unsigned char command, unsigned char length, char *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void internal_comm_add_tx_message           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a message to the transmit queue. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>command</em>&nbsp;</td><td>The command we wish to perform </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the data field </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>The data we wish to send </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00166">166</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm_8h-source.html#l00096">UC_MESSAGE::checksum</a>, <a class="el" href="internal__comm_8h-source.html#l00098">UC_MESSAGE::cmd</a>, <a class="el" href="internal__comm_8h-source.html#l00102">UC_MESSAGE::data</a>, <a class="el" href="internal__comm__tx__queue_8c-source.html#l00043">int_comm_tx_queue_add()</a>, and <a class="el" href="internal__comm_8h-source.html#l00100">UC_MESSAGE::length</a>.</p>

<p>Referenced by <a class="el" href="antenna__ctrl_8c-source.html#l00121">antenna_ctrl_deactivate_outputs()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00139">antenna_ctrl_send_ant_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00231">antenna_ctrl_send_rx_ant_band_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00189">antenna_ctrl_send_rx_ant_data_to_bus()</a>, <a class="el" href="band__ctrl_8c-source.html#l00053">band_ctrl_send_band_data_to_bus()</a>, <a class="el" href="motherboard_2computer__interface_8c-source.html#l00175">computer_interface_parse_data()</a>, <a class="el" href="motherboard_2main_8c-source.html#l00306">main()</a>, <a class="el" href="motherboard_2main_8c-source.html#l00154">parse_internal_comm_message()</a>, <a class="el" href="motherboard_2main_8c-source.html#l00301">ps2_process_key()</a>, <a class="el" href="radio__interface_8c-source.html#l00205">radio_poll_status()</a>, <a class="el" href="front__panel_2main_8c-source.html#l00161">shutdown_device()</a>, and <a class="el" href="sub__menu_8c-source.html#l00144">sub_menu_send_data_to_bus()</a>.</p>

</div>
</div><p>
<a class="anchor" name="038459fe5d58ddbde1ed8459d3b9bbce"></a><!-- doxytag: member="internal_comm.c::internal_comm_init" ref="038459fe5d58ddbde1ed8459d3b9bbce" args="(void(*func_ptr_rx)(UC_MESSAGE), void(*func_ptr_tx)(char))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void internal_comm_init           </td>
          <td>(</td>
          <td class="paramtype">void(*)(<a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a>)&nbsp;</td>
          <td class="paramname"> <em>func_ptr_rx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(char)&nbsp;</td>
          <td class="paramname"> <em>func_ptr_tx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize the internal communication. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>func_ptr_rx</em>&nbsp;</td><td>The function you wish to call when a new message has been recieved and should be parsed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>func_ptr_tx</em>&nbsp;</td><td>The function used to send data to the hardware handeling the data transmission </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00068">68</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm_8h-source.html#l00112">struct_uc_com::char_count</a>, <a class="el" href="internal__comm_8h-source.html#l00110">struct_uc_com::checksum</a>, <a class="el" href="internal__comm_8c.html#1bb3b57523849b2a6507039940dc7495">f_ptr_rx</a>, <a class="el" href="internal__comm_8c.html#733ad7cf6722dfbf0c368f8e39a2cce7">f_ptr_tx</a>, <a class="el" href="internal__comm_8h-source.html#l00108">struct_uc_com::flags</a>, <a class="el" href="internal__comm__rx__queue_8c-source.html#l00076">int_comm_rx_queue_dropall()</a>, and <a class="el" href="internal__comm__tx__queue_8c-source.html#l00076">int_comm_tx_queue_dropall()</a>.</p>

<p>Referenced by <a class="el" href="front__panel_2main_8c-source.html#l00293">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="64c4f318386e5cad700f6c5e08677c6f"></a><!-- doxytag: member="internal_comm.c::internal_comm_poll_rx_queue" ref="64c4f318386e5cad700f6c5e08677c6f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char internal_comm_poll_rx_queue           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Polls the RX queue in the internal communication and calls the function defined in internal_comm_init. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>1 if a message was in the buffer and got parsed, 0 if not </dd></dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00091">91</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm_8c.html#1bb3b57523849b2a6507039940dc7495">f_ptr_rx</a>, <a class="el" href="internal__comm__rx__queue_8c-source.html#l00066">int_comm_rx_queue_drop()</a>, <a class="el" href="internal__comm__rx__queue_8c-source.html#l00059">int_comm_rx_queue_get()</a>, and <a class="el" href="internal__comm__rx__queue_8c-source.html#l00084">int_comm_rx_queue_is_empty()</a>.</p>

<p>Referenced by <a class="el" href="front__panel_2main_8c-source.html#l00293">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="35f8e503f80c8e1188ad09c1c0dde6ec"></a><!-- doxytag: member="internal_comm.c::internal_comm_poll_tx_queue" ref="35f8e503f80c8e1188ad09c1c0dde6ec" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char internal_comm_poll_tx_queue           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Polls the TX queue in the internal communication and sends the data if there is a message in the queue. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>1 if a message was in the buffer and got sent, 0 if not </dd></dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00105">105</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm__tx__queue_8c-source.html#l00059">int_comm_tx_queue_get()</a>, <a class="el" href="internal__comm__tx__queue_8c-source.html#l00084">int_comm_tx_queue_is_empty()</a>, <a class="el" href="internal__comm_8c-source.html#l00147">internal_comm_send_message()</a>, and <a class="el" href="internal__comm_8c-source.html#l00058">msg_not_acked</a>.</p>

<p>Referenced by <a class="el" href="front__panel_2main_8c-source.html#l00293">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b19320006eb32811d9c211f41e229f87"></a><!-- doxytag: member="internal_comm.c::internal_comm_send_message" ref="b19320006eb32811d9c211f41e229f87" args="(UC_MESSAGE tx_message)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void internal_comm_send_message           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a>&nbsp;</td>
          <td class="paramname"> <em>tx_message</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a message to the internal communication uart. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tx_message</em>&nbsp;</td><td>The message we wish to send </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00147">147</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm_8h-source.html#l00096">UC_MESSAGE::checksum</a>, <a class="el" href="internal__comm_8h-source.html#l00098">UC_MESSAGE::cmd</a>, <a class="el" href="internal__comm_8c-source.html#l00050">counter_tx_timeout</a>, <a class="el" href="internal__comm_8h-source.html#l00102">UC_MESSAGE::data</a>, <a class="el" href="internal__comm_8c.html#733ad7cf6722dfbf0c368f8e39a2cce7">f_ptr_tx</a>, <a class="el" href="internal__comm_8h-source.html#l00100">UC_MESSAGE::length</a>, <a class="el" href="internal__comm_8h-source.html#l00071">UC_COMM_MSG_POSTAMBLE</a>, and <a class="el" href="internal__comm_8h-source.html#l00069">UC_COMM_MSG_PREAMBLE</a>.</p>

<p>Referenced by <a class="el" href="internal__comm_8c-source.html#l00105">internal_comm_poll_tx_queue()</a>, and <a class="el" href="internal__comm_8c-source.html#l00183">internal_comm_resend()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 19 20:56:58 2010 for uC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
