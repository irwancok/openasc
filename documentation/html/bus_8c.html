<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>uC: wmv_bus/bus.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>wmv_bus/bus.c File Reference</h1>The communication bus protocol used in the openASC project.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &lt;avr/wdt.h&gt;</code><br>
<code>#include &lt;avr/io.h&gt;</code><br>
<code>#include &lt;avr/interrupt.h&gt;</code><br>
<code>#include &quot;<a class="el" href="bus_8h-source.html">bus.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="bus__tx__queue_8h-source.html">bus_tx_queue.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="bus__rx__queue_8h-source.html">bus_rx_queue.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="bus__commands_8h-source.html">bus_commands.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="bus__ping_8h-source.html">bus_ping.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="wmv__bus_2global_8h-source.html">global.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="bus__usart_8h-source.html">bus_usart.h</a>&quot;</code><br>

<p>
<a href="bus_8c-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="66e8708f99633602ea17873c9bed4b6d"></a><!-- doxytag: member="bus.c::bus_init" ref="66e8708f99633602ea17873c9bed4b6d" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#66e8708f99633602ea17873c9bed4b6d">bus_init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Init the communication bus. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#9869a6434da36c0bfa8573d68bed9b40">bus_set_address</a> (unsigned char addr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the address of this device on the bus.  <a href="#9869a6434da36c0bfa8573d68bed9b40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#ceb215ff9ef4810ef00434c1c02f6a4c">bus_allowed_to_send</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns if you are allowed to transmit data to the bus or not.  <a href="#ceb215ff9ef4810ef00434c1c02f6a4c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#978d35e07c79199b121997d80de56655">bus_get_address</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the address of this device.  <a href="#978d35e07c79199b121997d80de56655"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e17905990a3f145d02f7390f7c7676af"></a><!-- doxytag: member="bus.c::bus_send_message" ref="e17905990a3f145d02f7390f7c7676af" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#e17905990a3f145d02f7390f7c7676af">bus_send_message</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sends the first message in the FIFO TX queue to the communication bus. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1f8ed281f15b4e6e34cdcdb2bfb70932"></a><!-- doxytag: member="bus.c::bus_reset_tx_status" ref="1f8ed281f15b4e6e34cdcdb2bfb70932" args="(void)" -->
void __inline__&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#1f8ed281f15b4e6e34cdcdb2bfb70932">bus_reset_tx_status</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function that resets the bus status variables. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="524ab9ee02e43dff455677fdecfb5e21"></a><!-- doxytag: member="bus.c::bus_reset_rx_status" ref="524ab9ee02e43dff455677fdecfb5e21" args="(void)" -->
void __inline__&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#524ab9ee02e43dff455677fdecfb5e21">bus_reset_rx_status</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function that resets the bus status variables. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#ce52a77ee7a62558643de23c5f10f9c7">bus_is_master</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns if the bus is set to be master.  <a href="#ce52a77ee7a62558643de23c5f10f9c7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#ed493aabe32ac3eaafb77d4c23f15eb9">bus_set_is_master</a> (unsigned char state, unsigned char count)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the status if the device should be master or not.  <a href="#ed493aabe32ac3eaafb77d4c23f15eb9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#651be0f483dc1e17174069bbf991d653">bus_send_nack</a> (unsigned char to_addr, unsigned char error_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an NOT acknowledge.  <a href="#651be0f483dc1e17174069bbf991d653"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="069826b2c00193de5883c42ffc8c95fc"></a><!-- doxytag: member="bus.c::bus_send_ack" ref="069826b2c00193de5883c42ffc8c95fc" args="(unsigned char to_addr)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#069826b2c00193de5883c42ffc8c95fc">bus_send_ack</a> (unsigned char to_addr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an acknowledge. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#76f9639571632344a2a1ae4138663667">bus_get_device_count</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive the device count on the bus.  <a href="#76f9639571632344a2a1ae4138663667"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#bbcb4456ec66651e191189cc985bfeab">bus_set_device_count</a> (unsigned char <a class="el" href="front__panel_2main_8c.html#4e659bfe570f8e58593672bc9a8d22a7">device_count</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the number of devices that are on the bus.  <a href="#bbcb4456ec66651e191189cc985bfeab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2e40ef066b1f7231f314bc85779110ed"></a><!-- doxytag: member="bus.c::bus_resend_message" ref="2e40ef066b1f7231f314bc85779110ed" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#2e40ef066b1f7231f314bc85779110ed">bus_resend_message</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resend the last message. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="370f257e97b9adc5aeb57ef539ce8547"></a><!-- doxytag: member="bus.c::bus_check_tx_status" ref="370f257e97b9adc5aeb57ef539ce8547" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#370f257e97b9adc5aeb57ef539ce8547">bus_check_tx_status</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if there is anything that should be sent in the TX queue. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#4c78398b39ca1a317bcd94e32d3238ed">bus_add_tx_message</a> (unsigned char from_addr, unsigned char to_addr, unsigned char flags, unsigned char cmd, unsigned char length, unsigned char data[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a message to the TX queue which will be sent as soon as possible.  <a href="#4c78398b39ca1a317bcd94e32d3238ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#8900b6684889df452076e67b3a528bc8">bus_add_rx_message</a> (unsigned char from_addr, unsigned char to_addr, unsigned char flags, unsigned char cmd, unsigned char length, unsigned char data[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a message to the RX queue which will be sent as soon as possible.  <a href="#8900b6684889df452076e67b3a528bc8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d6dee76884c2faaaec40ea32a460600c"></a><!-- doxytag: member="bus.c::bus_add_new_message" ref="d6dee76884c2faaaec40ea32a460600c" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#d6dee76884c2faaaec40ea32a460600c">bus_add_new_message</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds the message bus_new_message into the RX queue. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#4541ef9a75addac3aaa4af88d8f03590">bus_message_nacked</a> (unsigned char addr, unsigned char error_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The message last sent was NACKED from the receiver.  <a href="#4541ef9a75addac3aaa4af88d8f03590"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="205fdad7d74dbd67e7b31c9630819cb9"></a><!-- doxytag: member="bus.c::bus_message_acked" ref="205fdad7d74dbd67e7b31c9630819cb9" args="(unsigned char addr)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#205fdad7d74dbd67e7b31c9630819cb9">bus_message_acked</a> (unsigned char addr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The message last sent was acknowledged from the receiver. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#56c7d1c90fd3b9b05b882677670d151e">ISR</a> (ISR_BUS_USART_DATA)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#4ea7bd97e74a54718958107b4d2da063">ISR</a> (ISR_BUS_USART_RECV)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#efcb4b9972f80d02e113869d694b4aab">ISR</a> (ISR_BUS_USART_TRANS)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#90fe1670ecc0478c38c6903ffa1fb1ac">ISR</a> (ISR_BUS_TIMER_COMPARE)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="84490b82413d551e70a48596f334f0b0"></a><!-- doxytag: member="bus.c::bus_status" ref="84490b82413d551e70a48596f334f0b0" args="" -->
<a class="el" href="structbus__status__struct.html">bus_status_struct</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#84490b82413d551e70a48596f334f0b0">bus_status</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The bus status structure. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cd52bf6c724f70eaa5816bdaed78749b"></a><!-- doxytag: member="bus.c::calc_checksum" ref="cd52bf6c724f70eaa5816bdaed78749b" args="" -->
unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#cd52bf6c724f70eaa5816bdaed78749b">calc_checksum</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Variable used to calculate the checksum when receiving a message. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="caaf7c4fe8a90cd7e2f50cdcaf6cdb6a"></a><!-- doxytag: member="bus.c::bus_new_message" ref="caaf7c4fe8a90cd7e2f50cdcaf6cdb6a" args="" -->
<a class="el" href="structBUS__MESSAGE.html">BUS_MESSAGE</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#caaf7c4fe8a90cd7e2f50cdcaf6cdb6a">bus_new_message</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The new message. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="025b74f1b48eb3c20b99a7158fb8d1f4"></a><!-- doxytag: member="bus.c::timer_bus_timeout" ref="025b74f1b48eb3c20b99a7158fb8d1f4" args="" -->
unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#025b74f1b48eb3c20b99a7158fb8d1f4">timer_bus_timeout</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Counter that keeps track of how long time ago it was when we received a new character and if it's over the limit we erase all the RX buffer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6e9739c76fabbaee818907fb42a373d4"></a><!-- doxytag: member="bus.c::counter_sync_timeout" ref="6e9739c76fabbaee818907fb42a373d4" args="" -->
unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#6e9739c76fabbaee818907fb42a373d4">counter_sync_timeout</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Counter that keeps track of how long time ago it was when we received a new SYNC message on the BUS. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="180f52cd105a2002c6a3209f0ed75440"></a><!-- doxytag: member="bus.c::counter_130us" ref="180f52cd105a2002c6a3209f0ed75440" args="" -->
unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8c.html#180f52cd105a2002c6a3209f0ed75440">counter_130us</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Counter which keeps track of each time the 130us timer counts up. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The communication bus protocol used in the openASC project. 
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Mikael Larsmark, SM2WMV </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-01-25 <div class="fragment"><pre class="fragment"><span class="preprocessor"> #include "<a class="code" href="bus_8c.html" title="The communication bus protocol used in the openASC project.">wmv_bus/bus.c</a>"</span> 
</pre></div> </dd></dl>

<p>Definition in file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="8900b6684889df452076e67b3a528bc8"></a><!-- doxytag: member="bus.c::bus_add_rx_message" ref="8900b6684889df452076e67b3a528bc8" args="(unsigned char from_addr, unsigned char to_addr, unsigned char flags, unsigned char cmd, unsigned char length, unsigned char data[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_add_rx_message           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>from_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>to_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>data</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a message to the RX queue which will be sent as soon as possible. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>from_addr</em>&nbsp;</td><td>The address of the sender </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>to_addr</em>&nbsp;</td><td>The address to the receiever </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>Different flags, see defines </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>The command performed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the data received </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>The data receieved </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00324">324</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00234">BUS_MESSAGE::cmd</a>, <a class="el" href="bus_8h-source.html#l00238">BUS_MESSAGE::data</a>, <a class="el" href="bus_8h-source.html#l00232">BUS_MESSAGE::flags</a>, <a class="el" href="bus_8h-source.html#l00226">BUS_MESSAGE::from_addr</a>, <a class="el" href="bus_8h-source.html#l00236">BUS_MESSAGE::length</a>, <a class="el" href="bus__rx__queue_8c-source.html#l00055">rx_queue_add()</a>, and <a class="el" href="bus_8h-source.html#l00228">BUS_MESSAGE::to_addr</a>.</p>

</div>
</div><p>
<a class="anchor" name="4c78398b39ca1a317bcd94e32d3238ed"></a><!-- doxytag: member="bus.c::bus_add_tx_message" ref="4c78398b39ca1a317bcd94e32d3238ed" args="(unsigned char from_addr, unsigned char to_addr, unsigned char flags, unsigned char cmd, unsigned char length, unsigned char data[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_add_tx_message           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>from_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>to_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>data</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a message to the TX queue which will be sent as soon as possible. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>from_addr</em>&nbsp;</td><td>The address of the sender </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>to_addr</em>&nbsp;</td><td>The address to the receiever </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>Different flags, see defines </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>The command wanted to be performed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the data wanting to be sent </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>The data wanted to be transmitted to the receiever </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00291">291</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8c-source.html#l00114">bus_allowed_to_send()</a>, <a class="el" href="bus__commands_8h-source.html#l00035">BUS_CMD_SYNC</a>, <a class="el" href="bus_8h-source.html#l00230">BUS_MESSAGE::checksum</a>, <a class="el" href="bus_8h-source.html#l00234">BUS_MESSAGE::cmd</a>, <a class="el" href="bus_8h-source.html#l00238">BUS_MESSAGE::data</a>, <a class="el" href="bus_8h-source.html#l00232">BUS_MESSAGE::flags</a>, <a class="el" href="bus_8h-source.html#l00226">BUS_MESSAGE::from_addr</a>, <a class="el" href="bus_8h-source.html#l00236">BUS_MESSAGE::length</a>, <a class="el" href="bus_8h-source.html#l00228">BUS_MESSAGE::to_addr</a>, and <a class="el" href="bus__tx__queue_8c-source.html#l00056">tx_queue_add()</a>.</p>

<p>Referenced by <a class="el" href="antenna__ctrl_8c-source.html#l00121">antenna_ctrl_deactivate_outputs()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00139">antenna_ctrl_send_ant_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00231">antenna_ctrl_send_rx_ant_band_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00189">antenna_ctrl_send_rx_ant_data_to_bus()</a>, <a class="el" href="band__ctrl_8c-source.html#l00053">band_ctrl_send_band_data_to_bus()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00184">bus_parse_message()</a>, <a class="el" href="bus_8c-source.html#l00229">bus_send_ack()</a>, <a class="el" href="bus_8c-source.html#l00223">bus_send_nack()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00326">ISR()</a>, <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>, <a class="el" href="front__panel_2main_8c-source.html#l00285">send_ping()</a>, and <a class="el" href="sub__menu_8c-source.html#l00144">sub_menu_send_data_to_bus()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ceb215ff9ef4810ef00434c1c02f6a4c"></a><!-- doxytag: member="bus.c::bus_allowed_to_send" ref="ceb215ff9ef4810ef00434c1c02f6a4c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char bus_allowed_to_send           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns if you are allowed to transmit data to the bus or not. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>1 if it's allowed to transmit and 0 if not </dd></dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00114">114</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00185">BUS_STATUS_MASTER_SENT_SYNC_BIT</a>, and <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00291">bus_add_tx_message()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00326">ISR()</a>, and <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="978d35e07c79199b121997d80de56655"></a><!-- doxytag: member="bus.c::bus_get_address" ref="978d35e07c79199b121997d80de56655" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char bus_get_address           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the address of this device. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The address of this device </dd></dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00123">123</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00266">bus_status_struct::ext_addr</a>.</p>

<p>Referenced by <a class="el" href="antenna__ctrl_8c-source.html#l00121">antenna_ctrl_deactivate_outputs()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00139">antenna_ctrl_send_ant_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00231">antenna_ctrl_send_rx_ant_band_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00189">antenna_ctrl_send_rx_ant_data_to_bus()</a>, <a class="el" href="band__ctrl_8c-source.html#l00053">band_ctrl_send_band_data_to_bus()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00184">bus_parse_message()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00326">ISR()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00277">main()</a>, <a class="el" href="front__panel_2main_8c-source.html#l00285">send_ping()</a>, and <a class="el" href="sub__menu_8c-source.html#l00144">sub_menu_send_data_to_bus()</a>.</p>

</div>
</div><p>
<a class="anchor" name="76f9639571632344a2a1ae4138663667"></a><!-- doxytag: member="bus.c::bus_get_device_count" ref="76f9639571632344a2a1ae4138663667" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char bus_get_device_count           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Receive the device count on the bus. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of devices on the bus </dd></dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00235">235</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00272">bus_status_struct::device_count</a>.</p>

<p>Referenced by <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ce52a77ee7a62558643de23c5f10f9c7"></a><!-- doxytag: member="bus.c::bus_is_master" ref="ce52a77ee7a62558643de23c5f10f9c7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char bus_is_master           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns if the bus is set to be master. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>1 if it is configured to be master, 0 otherwise </dd></dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00196">196</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00179">BUS_STATUS_DEVICE_IS_MASTER_BIT</a>, and <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>.</p>

<p>Referenced by <a class="el" href="front__panel_2main_8c-source.html#l00620">ISR()</a>, and <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4541ef9a75addac3aaa4af88d8f03590"></a><!-- doxytag: member="bus.c::bus_message_nacked" ref="4541ef9a75addac3aaa4af88d8f03590" args="(unsigned char addr, unsigned char error_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_message_nacked           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>error_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The message last sent was NACKED from the receiver. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address of the device that sent the NACK </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>error_type</em>&nbsp;</td><td>Contains information why the message was NACKED </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00348">348</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8c-source.html#l00248">bus_resend_message()</a>, <a class="el" href="bus_8h-source.html#l00197">BUS_STATUS_MESSAGE_ACK_TIMEOUT</a>, <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>, <a class="el" href="bus_8h-source.html#l00228">BUS_MESSAGE::to_addr</a>, and <a class="el" href="bus__tx__queue_8c-source.html#l00086">tx_queue_get()</a>.</p>

<p>Referenced by <a class="el" href="driver__unit_2main_8c-source.html#l00184">bus_parse_message()</a>, and <a class="el" href="event__handler_8c-source.html#l00872">event_bus_parse_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="651be0f483dc1e17174069bbf991d653"></a><!-- doxytag: member="bus.c::bus_send_nack" ref="651be0f483dc1e17174069bbf991d653" args="(unsigned char to_addr, unsigned char error_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_send_nack           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>to_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>error_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send an NOT acknowledge. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>to_addr</em>&nbsp;</td><td>Which address we wish to send the ping to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>error_type</em>&nbsp;</td><td>Why was the message nacked, see <a class="el" href="bus_8h.html" title="The communication bus protocol used in the openASC project.">bus.h</a> for more information about BUS errors </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00223">223</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8c-source.html#l00291">bus_add_tx_message()</a>, <a class="el" href="bus_8h-source.html#l00137">BUS_BROADCAST_ADDR</a>, <a class="el" href="bus__commands_8h-source.html#l00031">BUS_CMD_NACK</a>, and <a class="el" href="bus_8h-source.html#l00266">bus_status_struct::ext_addr</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00386">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9869a6434da36c0bfa8573d68bed9b40"></a><!-- doxytag: member="bus.c::bus_set_address" ref="9869a6434da36c0bfa8573d68bed9b40" args="(unsigned char addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_set_address           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>addr</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the address of this device on the bus. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address of this device </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00108">108</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00266">bus_status_struct::ext_addr</a>.</p>

<p>Referenced by <a class="el" href="driver__unit_2main_8c-source.html#l00277">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="bbcb4456ec66651e191189cc985bfeab"></a><!-- doxytag: member="bus.c::bus_set_device_count" ref="bbcb4456ec66651e191189cc985bfeab" args="(unsigned char device_count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_set_device_count           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>device_count</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the number of devices that are on the bus. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device_count</em>&nbsp;</td><td>The number of devices on the bus, ie the number of time slots </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00241">241</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00201">BUS_TIME_MULTIPLIER</a>, <a class="el" href="bus_8h-source.html#l00272">bus_status_struct::device_count</a>, and <a class="el" href="bus_8h-source.html#l00274">bus_status_struct::device_count_mult</a>.</p>

</div>
</div><p>
<a class="anchor" name="ed493aabe32ac3eaafb77d4c23f15eb9"></a><!-- doxytag: member="bus.c::bus_set_is_master" ref="ed493aabe32ac3eaafb77d4c23f15eb9" args="(unsigned char state, unsigned char count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_set_is_master           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the status if the device should be master or not. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>state</em>&nbsp;</td><td>1 if you wish the device to be master, 0 if you wish that it should be slave </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>The nr of devices </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00206">206</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="front__panel_2main_8h-source.html#l00035">BUS_STATUS_ALLOWED_TO_SEND_BIT</a>, <a class="el" href="bus_8h-source.html#l00179">BUS_STATUS_DEVICE_IS_MASTER_BIT</a>, <a class="el" href="bus_8h-source.html#l00195">BUS_STATUS_FORCE_SYNC</a>, <a class="el" href="bus_8h-source.html#l00201">BUS_TIME_MULTIPLIER</a>, <a class="el" href="bus_8h-source.html#l00272">bus_status_struct::device_count</a>, <a class="el" href="bus_8h-source.html#l00274">bus_status_struct::device_count_mult</a>, and <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>.</p>

<p>Referenced by <a class="el" href="driver__unit_2main_8c-source.html#l00277">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="90fe1670ecc0478c38c6903ffa1fb1ac"></a><!-- doxytag: member="bus.c::ISR" ref="90fe1670ecc0478c38c6903ffa1fb1ac" args="(ISR_BUS_TIMER_COMPARE)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR           </td>
          <td>(</td>
          <td class="paramtype">ISR_BUS_TIMER_COMPARE&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Timer interrupt with ~130us intervals 
<p>Definition at line <a class="el" href="bus_8c-source.html#l00512">512</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00171">BUS_ACK_WRAPAROUND_LIMIT</a>, <a class="el" href="bus_8c-source.html#l00196">bus_is_master()</a>, <a class="el" href="bus_8c-source.html#l00248">bus_resend_message()</a>, <a class="el" href="bus_8c-source.html#l00183">bus_reset_rx_status()</a>, <a class="el" href="bus_8h-source.html#l00185">BUS_STATUS_MASTER_SENT_SYNC_BIT</a>, <a class="el" href="bus_8h-source.html#l00197">BUS_STATUS_MESSAGE_ACK_TIMEOUT</a>, <a class="el" href="bus_8h-source.html#l00187">BUS_STATUS_TIME_SLOT_ACTIVE</a>, <a class="el" href="bus_8h-source.html#l00167">BUS_SYNC_TIMEOUT_LIMIT</a>, <a class="el" href="bus_8h-source.html#l00175">BUS_TIMEOUT_LIMIT</a>, <a class="el" href="bus_8c-source.html#l00075">counter_130us</a>, <a class="el" href="bus_8c-source.html#l00072">counter_sync_timeout</a>, <a class="el" href="bus_8h-source.html#l00272">bus_status_struct::device_count</a>, <a class="el" href="bus_8h-source.html#l00274">bus_status_struct::device_count_mult</a>, <a class="el" href="errors_8h-source.html#l00032">ERROR_TYPE_BUS_SYNC</a>, <a class="el" href="event__handler_8c-source.html#l00065">event_set_error()</a>, <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>, <a class="el" href="bus_8h-source.html#l00264">bus_status_struct::frame_counter</a>, <a class="el" href="front__panel_2led__control_8c-source.html#l00067">led_set_error()</a>, <a class="el" href="front__panel_2led__control_8h-source.html#l00039">LED_STATE_ON</a>, <a class="el" href="bus_8h-source.html#l00268">bus_status_struct::lower_limit</a>, <a class="el" href="bus_8c-source.html#l00068">timer_bus_timeout</a>, <a class="el" href="bus__tx__queue_8c-source.html#l00104">tx_queue_dropall()</a>, <a class="el" href="bus_8h-source.html#l00270">bus_status_struct::upper_limit</a>, and <a class="el" href="bus_8h-source.html#l00284">bus_status_struct::wraparounds</a>.</p>

</div>
</div><p>
<a class="anchor" name="efcb4b9972f80d02e113869d694b4aab"></a><!-- doxytag: member="bus.c::ISR" ref="efcb4b9972f80d02e113869d694b4aab" args="(ISR_BUS_USART_TRANS)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR           </td>
          <td>(</td>
          <td class="paramtype">ISR_BUS_USART_TRANS&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
USART data transmit interrupt 
<p>Definition at line <a class="el" href="bus_8c-source.html#l00506">506</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00193">BUS_STATUS_RECEIVE_ON</a>, <a class="el" href="bus_8h-source.html#l00191">BUS_STATUS_SEND_ACTIVE</a>, and <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>.</p>

</div>
</div><p>
<a class="anchor" name="4ea7bd97e74a54718958107b4d2da063"></a><!-- doxytag: member="bus.c::ISR" ref="4ea7bd97e74a54718958107b4d2da063" args="(ISR_BUS_USART_RECV)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR           </td>
          <td>(</td>
          <td class="paramtype">ISR_BUS_USART_RECV&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
USART data receive interrupt 
<p>Definition at line <a class="el" href="bus_8c-source.html#l00386">386</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8c-source.html#l00341">bus_add_new_message()</a>, <a class="el" href="bus_8h-source.html#l00137">BUS_BROADCAST_ADDR</a>, <a class="el" href="bus_8h-source.html#l00221">BUS_CHECKSUM_ERROR</a>, <a class="el" href="bus__commands_8h-source.html#l00037">BUS_CMD_PING</a>, <a class="el" href="bus__commands_8h-source.html#l00035">BUS_CMD_SYNC</a>, <a class="el" href="bus_8h-source.html#l00218">BUS_MESSAGE_FLAGS_NEED_ACK</a>, <a class="el" href="bus__ping_8c-source.html#l00041">bus_ping_new_stamp()</a>, <a class="el" href="bus_8c-source.html#l00183">bus_reset_rx_status()</a>, <a class="el" href="bus_8c-source.html#l00229">bus_send_ack()</a>, <a class="el" href="bus_8c-source.html#l00223">bus_send_nack()</a>, <a class="el" href="front__panel_2main_8h-source.html#l00035">BUS_STATUS_ALLOWED_TO_SEND_BIT</a>, <a class="el" href="bus_8h-source.html#l00185">BUS_STATUS_MASTER_SENT_SYNC_BIT</a>, <a class="el" href="front__panel_2main_8h-source.html#l00037">BUS_STATUS_PREAMBLE_FOUND_BIT</a>, <a class="el" href="bus_8h-source.html#l00193">BUS_STATUS_RECEIVE_ON</a>, <a class="el" href="bus_8h-source.html#l00201">BUS_TIME_MULTIPLIER</a>, <a class="el" href="bus_8c-source.html#l00061">calc_checksum</a>, <a class="el" href="bus_8h-source.html#l00278">bus_status_struct::char_count</a>, <a class="el" href="bus_8h-source.html#l00230">BUS_MESSAGE::checksum</a>, <a class="el" href="bus_8h-source.html#l00234">BUS_MESSAGE::cmd</a>, <a class="el" href="bus_8c-source.html#l00072">counter_sync_timeout</a>, <a class="el" href="bus_8h-source.html#l00238">BUS_MESSAGE::data</a>, <a class="el" href="bus_8h-source.html#l00272">bus_status_struct::device_count</a>, <a class="el" href="bus_8h-source.html#l00274">bus_status_struct::device_count_mult</a>, <a class="el" href="bus_8h-source.html#l00266">bus_status_struct::ext_addr</a>, <a class="el" href="bus_8h-source.html#l00232">BUS_MESSAGE::flags</a>, <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>, <a class="el" href="bus_8h-source.html#l00264">bus_status_struct::frame_counter</a>, <a class="el" href="bus_8h-source.html#l00226">BUS_MESSAGE::from_addr</a>, <a class="el" href="bus_8h-source.html#l00236">BUS_MESSAGE::length</a>, <a class="el" href="bus_8h-source.html#l00282">bus_status_struct::prev_char</a>, <a class="el" href="bus_8c-source.html#l00068">timer_bus_timeout</a>, and <a class="el" href="bus_8h-source.html#l00228">BUS_MESSAGE::to_addr</a>.</p>

</div>
</div><p>
<a class="anchor" name="56c7d1c90fd3b9b05b882677670d151e"></a><!-- doxytag: member="bus.c::ISR" ref="56c7d1c90fd3b9b05b882677670d151e" args="(ISR_BUS_USART_DATA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR           </td>
          <td>(</td>
          <td class="paramtype">ISR_BUS_USART_DATA&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
USART data interrupt 
<p>Definition at line <a class="el" href="bus_8c-source.html#l00381">381</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 19 20:56:58 2010 for uC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
