<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>uC: front_panel/sequencer.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>front_panel/sequencer.c</h1><a href="sequencer_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="comment">//    Copyright (C) 2008  Mikael Larsmark, SM2WMV</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">//    This program is free software: you can redistribute it and/or modify</span>
<a name="l00011"></a>00011 <span class="comment">//    it under the terms of the GNU General Public License as published by</span>
<a name="l00012"></a>00012 <span class="comment">//    the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00013"></a>00013 <span class="comment">//    (at your option) any later version.</span>
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00015"></a>00015 <span class="comment">//    This program is distributed in the hope that it will be useful,</span>
<a name="l00016"></a>00016 <span class="comment">//    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00017"></a>00017 <span class="comment">//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00018"></a>00018 <span class="comment">//    GNU General Public License for more details.</span>
<a name="l00019"></a>00019 <span class="comment">//</span>
<a name="l00020"></a>00020 <span class="comment">//    You should have received a copy of the GNU General Public License</span>
<a name="l00021"></a>00021 <span class="comment">//    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;avr/io.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;avr/interrupt.h&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include "<a class="code" href="radio__interface_8h.html" title="Radio interface, such as PTT AMP, PTT Radio, CAT etc.">radio_interface.h</a>"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include "<a class="code" href="sequencer_8h.html" title="Sequencer.">sequencer.h</a>"</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include "main.h"</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include "led_control.h"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="front__panel_2usart_8h.html" title="USART routines.">usart.h</a>"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include "../global.h"</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include "../event_queue.h"</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include "<a class="code" href="antenna__ctrl_8h.html" title="Antenna control functions.">antenna_ctrl.h</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include "<a class="code" href="eeprom_8h.html" title="EEPROM functions.">eeprom.h</a>"</span>
<a name="l00038"></a>00038 
<a name="l00040"></a><a class="code" href="sequencer_8c.html#297ab6ae481decc5b654b11033b61a5d">00040</a> <span class="preprocessor">#define PTT_ACTIVE_FOOTSWITCH                   0</span>
<a name="l00042"></a><a class="code" href="sequencer_8c.html#d60968742cb87ad1e5a4955db2fb04ac">00042</a> <span class="preprocessor">#define PTT_ACTIVE_RADIO_SENSE          1</span>
<a name="l00044"></a><a class="code" href="sequencer_8c.html#7f794cc4a66dade4c3a970c75ad2362e">00044</a> <span class="preprocessor">#define PTT_ACTIVE_COMPUTER_RTS         2</span>
<a name="l00045"></a>00045 <span class="preprocessor"></span>
<a name="l00046"></a>00046 <span class="comment">//TODO: Fix so that we don't get problems with having computer AND footswitch PTTed at the same time if</span>
<a name="l00047"></a>00047 <span class="comment">//      the different amp/radio/inhibit are enabled on different inputs...THIS IS VERY IMPORTANT THAT IT WORKS</span>
<a name="l00048"></a>00048 <span class="comment">//      PROPERLY!!! Maybe solution is to only use FIRST WINS?</span>
<a name="l00049"></a>00049 <span class="comment">//TODO: Finish the radio sense input stuff</span>
<a name="l00050"></a>00050 
<a name="l00052"></a><a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61">00052</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a> = 0;
<a name="l00053"></a>00053 
<a name="l00055"></a><a class="code" href="sequencer_8c.html#e3993ee1882aa3846a9eca8d74bd6f76">00055</a> <a class="code" href="structstruct__ptt.html" title="PTT Sequencer struct.">struct_ptt</a> <a class="code" href="sequencer_8c.html#e3993ee1882aa3846a9eca8d74bd6f76" title="PTT sequencer data.">ptt_sequencer</a>;
<a name="l00056"></a>00056 
<a name="l00058"></a><a class="code" href="sequencer_8h.html#70c4a395961e80655ad14fe4779f7fd3">00058</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="sequencer_8c.html#70c4a395961e80655ad14fe4779f7fd3" title="Retrieve which PTT inputs that are currently active, defines above.">sequencer_get_ptt_active</a>(<span class="keywordtype">void</span>) {
<a name="l00059"></a>00059         <span class="keywordflow">return</span>(<a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a>);
<a name="l00060"></a>00060 }
<a name="l00061"></a>00061 
<a name="l00063"></a><a class="code" href="sequencer_8h.html#a29ae1c1d47ca3fbd6a910beb32d10e8">00063</a> <span class="keywordtype">void</span> <a class="code" href="sequencer_8c.html#a29ae1c1d47ca3fbd6a910beb32d10e8" title="This function will load data from the eeprom to the ptt_sequencer struct.">sequencer_load_eeprom</a>(<span class="keywordtype">void</span>) {
<a name="l00064"></a>00064         <a class="code" href="eeprom_8c.html#1a16336e64981c88fed8ab3855ecd4e4" title="Get the ptt structure from the EEPROM.">eeprom_get_ptt_data</a>(&amp;ptt_sequencer);
<a name="l00065"></a>00065 }
<a name="l00066"></a>00066 
<a name="l00068"></a><a class="code" href="sequencer_8h.html#205749ea1a958bd5efa4f5abc1a6ff2e">00068</a> <span class="keywordtype">void</span> <a class="code" href="sequencer_8c.html#205749ea1a958bd5efa4f5abc1a6ff2e" title="Function to be called if the footswitch is pressed.">sequencer_footsw_pressed</a>(<span class="keywordtype">void</span>) {
<a name="l00069"></a>00069         <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#0a2333714aea2d77855a876b472a3ab3" title="Flag bit offset for the footswitch.">PTT_INPUT_FOOTSWITCH</a>)) {
<a name="l00070"></a>00070                 <span class="comment">//Check so that the computer does not already PTT the device, if so we just skip this event</span>
<a name="l00071"></a>00071                 <span class="keywordflow">if</span> ((<a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8c.html#7f794cc4a66dade4c3a970c75ad2362e" title="The computer PTT input is active.">PTT_ACTIVE_COMPUTER_RTS</a>)) == 0) {
<a name="l00072"></a>00072                         <span class="keywordflow">if</span> (<a class="code" href="front__panel_2main_8c.html#33e0e0ca61cfd86443ceb19d5c7ce50b" title="Get the inhibit state This function is used to get the inhibit state, which is used...">main_get_inhibit_state</a>() == <a class="code" href="front__panel_2main_8h.html#134c1d1af939afa5cdbca4c5cc75b9445f6ae3a8b4c6ce9ebf589cac8adefb68" title="Inhibit state, OK to start a transmission.">INHIBIT_OK_TO_SEND</a>) {
<a name="l00073"></a>00073                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#d6c6dd0edb44339684cb56ee5968c0d5" title="Set the TX ACTIVE output to high.">radio_tx_active</a>, 0, <a class="code" href="sequencer_8h.html#aae40a289cf630e5a9f47e737ee7752e" title="Event that the radio should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_TX_ACTIVE_ON</a>);
<a name="l00074"></a>00074                                 
<a name="l00075"></a>00075                                 <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#5fa1f5b6c64fa66ea64ddedcc2059fbc" title="Flags on which sequencer variables that are enabled.">active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#428ea44a5577b06ef0f6f1070065c65b" title="Sequencer enabled for AMP.">SEQUENCER_PTT_AMP_ENABLED</a>)) {
<a name="l00076"></a>00076                                         <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#dbaa59761b81f7ba3e92437db2680006" title="Activate PTT amp.">radio_amp_ptt_active</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#46c2c68b12d4cd52e3d7d86af46fa498" title="The delay before the amp is PTTed after the input PTT has been activated.">amp_pre_delay</a> * 10, <a class="code" href="sequencer_8h.html#f5a386f4adf5a932b756b540b8f6be79" title="Event that the amp should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_AMP_ON</a>);
<a name="l00077"></a>00077                                 }
<a name="l00078"></a>00078                                 
<a name="l00079"></a>00079                                 <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#5fa1f5b6c64fa66ea64ddedcc2059fbc" title="Flags on which sequencer variables that are enabled.">active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#4ecfaca15b56017b6b8b24ed0e2bdb95" title="Sequencer enabled for RADIO.">SEQUENCER_PTT_RADIO_ENABLED</a>)) {
<a name="l00080"></a>00080                                         <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#ccffdcb09e8fc6a32df02fe22268f774" title="Activate the radio PTT.">radio_ptt_active</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#702e757af8539ea1b50591e2cc00b799" title="The delay before the radio is PTTed after the input PTT has been activated.">radio_pre_delay</a> * 10, <a class="code" href="sequencer_8h.html#f38759260db765aa98a8036725db06cd" title="Event that the radio should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_RADIO_ON</a>);
<a name="l00081"></a>00081                                 }
<a name="l00082"></a>00082                                 
<a name="l00083"></a>00083                                 <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#5fa1f5b6c64fa66ea64ddedcc2059fbc" title="Flags on which sequencer variables that are enabled.">active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#96aeef2285686486d8093a8a475679be" title="Sequencer enabled for INHIBIT.">SEQUENCER_PTT_INHIBIT_ENABLED</a>)) {
<a name="l00084"></a>00084                                         <span class="keywordflow">if</span> ((ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#eebdfa78b7e9c83edc88a73337fe55d7" title="Flag bit offset for the inhibit polarity.">PTT_INPUT_INHIBIT_POLARITY</a>)) == 0)   {
<a name="l00085"></a>00085                                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#10509297dec3040da555bc74e07dee04" title="Set the inhibit signal to low.">radio_inhibit_low</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#239dddd85cd4a89a9fdbc2653fbcacd1" title="The delay before the inhibit is activated after the input PTT has been activated...">inhibit_pre_delay</a> * 10, <a class="code" href="sequencer_8h.html#d25126250cfc3462e8b59308fc6f2a0d" title="Event that the inhibit output should be on.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_ON</a>);
<a name="l00086"></a>00086                                         }
<a name="l00087"></a>00087                                         <span class="keywordflow">else</span> {
<a name="l00088"></a>00088                                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#ac6dcfef06b5c2f9bb8913b780889758" title="Set the inhibit signal to high.">radio_inhibit_high</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#239dddd85cd4a89a9fdbc2653fbcacd1" title="The delay before the inhibit is activated after the input PTT has been activated...">inhibit_pre_delay</a> * 10, <a class="code" href="sequencer_8h.html#d25126250cfc3462e8b59308fc6f2a0d" title="Event that the inhibit output should be on.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_ON</a>);
<a name="l00089"></a>00089                                         }
<a name="l00090"></a>00090                                 }
<a name="l00091"></a>00091                                 
<a name="l00092"></a>00092                                 <span class="comment">//Show that the PTT is (also) activated by the footswitch now</span>
<a name="l00093"></a>00093                                 <a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a> |= (1&lt;&lt;<a class="code" href="sequencer_8c.html#297ab6ae481decc5b654b11033b61a5d" title="The footswitch PTT input is active.">PTT_ACTIVE_FOOTSWITCH</a>);
<a name="l00094"></a>00094                         }
<a name="l00095"></a>00095                 }
<a name="l00096"></a>00096         }
<a name="l00097"></a>00097 }
<a name="l00098"></a>00098 
<a name="l00100"></a><a class="code" href="sequencer_8h.html#447cb34cbaba75283524b32ea1e1fc35">00100</a> <span class="keywordtype">void</span> <a class="code" href="sequencer_8c.html#447cb34cbaba75283524b32ea1e1fc35" title="Function to be called if the footswitch is released.">sequencer_footsw_released</a>(<span class="keywordtype">void</span>) {
<a name="l00101"></a>00101         <span class="comment">//Check if the footswitch input is enabled</span>
<a name="l00102"></a>00102         <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#0a2333714aea2d77855a876b472a3ab3" title="Flag bit offset for the footswitch.">PTT_INPUT_FOOTSWITCH</a>)) {
<a name="l00103"></a>00103                 <span class="comment">//If the computer does PTT, we cannot stop the sequence, the computer will</span>
<a name="l00104"></a>00104                 <span class="keywordflow">if</span> (((ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#fa21a420a829c483647804e3bbc1803f" title="Flag bit offset for the COMPUTER RTS signal.">PTT_INPUT_COMPUTER_RTS</a>)) &amp;&amp; ((<a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8c.html#7f794cc4a66dade4c3a970c75ad2362e" title="The computer PTT input is active.">PTT_ACTIVE_COMPUTER_RTS</a>)) == 0)) || (ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#fa21a420a829c483647804e3bbc1803f" title="Flag bit offset for the COMPUTER RTS signal.">PTT_INPUT_COMPUTER_RTS</a>)) == 0) {
<a name="l00105"></a>00105                         <span class="comment">//Checks so that the footswitch wasn't relased premature, if it was, we drop the message to PTT the radio or amp</span>
<a name="l00106"></a>00106                         <span class="comment">//That way if we accidentally press the footswitch shortly we don't need to go through the sequencer cycle if the</span>
<a name="l00107"></a>00107                         <span class="comment">//delays are longer than the footswitch was pressed (not very likely though)</span>
<a name="l00108"></a>00108                         <span class="keywordflow">if</span> (<a class="code" href="event__queue_8c.html#bf734c18b872c4ecc29108b083cc2a36" title="Drops all messages in the queue with a certain ID.">event_queue_drop_id</a>(<a class="code" href="sequencer_8h.html#f38759260db765aa98a8036725db06cd" title="Event that the radio should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_RADIO_ON</a>) == 0) {
<a name="l00109"></a>00109                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#282c423a5968304bf393977e2aca1468" title="Deactivate the radio PTT.">radio_ptt_deactive</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#b4f538805dcedc5be55360eed1de886b" title="The delay after the input PTT has been released and the radio PTT is released.">radio_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#7a371779f225b2ecf366d5f30192ab1f" title="Event that the radio should be deactivated from footswitch.">SEQUENCER_EVENT_TYPE_PTT_RADIO_OFF</a>);
<a name="l00110"></a>00110                         }
<a name="l00111"></a>00111                                 
<a name="l00112"></a>00112                         <span class="keywordflow">if</span> (<a class="code" href="event__queue_8c.html#bf734c18b872c4ecc29108b083cc2a36" title="Drops all messages in the queue with a certain ID.">event_queue_drop_id</a>(<a class="code" href="sequencer_8h.html#f5a386f4adf5a932b756b540b8f6be79" title="Event that the amp should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_AMP_ON</a>) == 0) {
<a name="l00113"></a>00113                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#c317b76e083257d47fe444dc9a3e8a46" title="Deactivate PTT amp.">radio_amp_ptt_deactive</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#722cda497689fc4fe50d0e6c15e6726e" title="The delay after the input PTT has been released and the amp PTT is released.">amp_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#ece8368b679b708e800b2ae3b20628c6" title="Event that the amp should be deactivated from footswitch.">SEQUENCER_EVENT_TYPE_PTT_AMP_OFF</a>);
<a name="l00114"></a>00114                         }
<a name="l00115"></a>00115         
<a name="l00116"></a>00116                         <span class="keywordflow">if</span> (<a class="code" href="event__queue_8c.html#bf734c18b872c4ecc29108b083cc2a36" title="Drops all messages in the queue with a certain ID.">event_queue_drop_id</a>(<a class="code" href="sequencer_8h.html#aae40a289cf630e5a9f47e737ee7752e" title="Event that the radio should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_TX_ACTIVE_ON</a>) == 0) {
<a name="l00117"></a>00117                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#eb4c7b45ff52decc8cd6da2666f8f88e" title="Set the TX ACTIVE output to high.">radio_tx_deactive</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#d35cc48fb05bb8c1da7c8e19759d2066" title="The delay after theinput PTT has been released and the antennas are switched.">antennas_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#6a89977d20bdd32f477dde7646f0ca8f" title="Event that the inhibit should be activated from footswitch.">SEQUENCER_EVENT_TYPE_PTT_TX_ACTIVE_OFF</a>);
<a name="l00118"></a>00118                         }
<a name="l00119"></a>00119                         
<a name="l00120"></a>00120                         <span class="keywordflow">if</span> (<a class="code" href="event__queue_8c.html#bf734c18b872c4ecc29108b083cc2a36" title="Drops all messages in the queue with a certain ID.">event_queue_drop_id</a>(<a class="code" href="sequencer_8h.html#d25126250cfc3462e8b59308fc6f2a0d" title="Event that the inhibit output should be on.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_ON</a>) == 0) {
<a name="l00121"></a>00121                                 <span class="keywordflow">if</span> ((ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#eebdfa78b7e9c83edc88a73337fe55d7" title="Flag bit offset for the inhibit polarity.">PTT_INPUT_INHIBIT_POLARITY</a>)) == 0)   <span class="comment">//Inhibit polarity = active low</span>
<a name="l00122"></a>00122                                         <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#ac6dcfef06b5c2f9bb8913b780889758" title="Set the inhibit signal to high.">radio_inhibit_high</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#919ecd74b5a2275ad15bc79f28cf2e8d" title="The delay after the input PTT has been released and the inhibit pin is released.">inhibit_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#765792034f6c1607059edeac24354bf2" title="Event that the TX active output should be off.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_OFF</a>);
<a name="l00123"></a>00123                                 <span class="keywordflow">else</span>
<a name="l00124"></a>00124                                         <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#10509297dec3040da555bc74e07dee04" title="Set the inhibit signal to low.">radio_inhibit_low</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#51bb98b0b9df549361707d08d93a37e6" title="The PTT SEQUENCER for the footswitch input.">footswitch</a>.<a class="code" href="structstruct__ptt__sequencer.html#919ecd74b5a2275ad15bc79f28cf2e8d" title="The delay after the input PTT has been released and the inhibit pin is released.">inhibit_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#765792034f6c1607059edeac24354bf2" title="Event that the TX active output should be off.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_OFF</a>);
<a name="l00125"></a>00125                         }
<a name="l00126"></a>00126                 }
<a name="l00127"></a>00127         
<a name="l00128"></a>00128                 <a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a> &amp;= ~(1&lt;&lt;<a class="code" href="sequencer_8c.html#297ab6ae481decc5b654b11033b61a5d" title="The footswitch PTT input is active.">PTT_ACTIVE_FOOTSWITCH</a>);
<a name="l00129"></a>00129         }
<a name="l00130"></a>00130 }
<a name="l00131"></a>00131 
<a name="l00133"></a><a class="code" href="sequencer_8h.html#e57c1a07f28becc0318f364b15196d25">00133</a> <span class="keywordtype">void</span> <a class="code" href="sequencer_8c.html#e57c1a07f28becc0318f364b15196d25" title="Function to be called if the computer rts is activated.">sequencer_computer_rts_activated</a>(<span class="keywordtype">void</span>) {
<a name="l00134"></a>00134         <span class="comment">//Check that the COMPUTER RTS input is activated</span>
<a name="l00135"></a>00135         <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#fa21a420a829c483647804e3bbc1803f" title="Flag bit offset for the COMPUTER RTS signal.">PTT_INPUT_COMPUTER_RTS</a>)) {
<a name="l00136"></a>00136                 <span class="comment">//Check if the footswitch is active, if so we just skip this event</span>
<a name="l00137"></a>00137                 <span class="keywordflow">if</span> ((<a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8c.html#297ab6ae481decc5b654b11033b61a5d" title="The footswitch PTT input is active.">PTT_ACTIVE_FOOTSWITCH</a>)) == 0) {
<a name="l00138"></a>00138                         <span class="keywordflow">if</span> (<a class="code" href="front__panel_2main_8c.html#33e0e0ca61cfd86443ceb19d5c7ce50b" title="Get the inhibit state This function is used to get the inhibit state, which is used...">main_get_inhibit_state</a>() == <a class="code" href="front__panel_2main_8h.html#134c1d1af939afa5cdbca4c5cc75b9445f6ae3a8b4c6ce9ebf589cac8adefb68" title="Inhibit state, OK to start a transmission.">INHIBIT_OK_TO_SEND</a>) {
<a name="l00139"></a>00139                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#d6c6dd0edb44339684cb56ee5968c0d5" title="Set the TX ACTIVE output to high.">radio_tx_active</a>, 0, <a class="code" href="sequencer_8h.html#aae40a289cf630e5a9f47e737ee7752e" title="Event that the radio should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_TX_ACTIVE_ON</a>);
<a name="l00140"></a>00140                                 
<a name="l00141"></a>00141                                 <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#5fa1f5b6c64fa66ea64ddedcc2059fbc" title="Flags on which sequencer variables that are enabled.">active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#428ea44a5577b06ef0f6f1070065c65b" title="Sequencer enabled for AMP.">SEQUENCER_PTT_AMP_ENABLED</a>)) {
<a name="l00142"></a>00142                                         <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#dbaa59761b81f7ba3e92437db2680006" title="Activate PTT amp.">radio_amp_ptt_active</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#46c2c68b12d4cd52e3d7d86af46fa498" title="The delay before the amp is PTTed after the input PTT has been activated.">amp_pre_delay</a> * 10, <a class="code" href="sequencer_8h.html#f5a386f4adf5a932b756b540b8f6be79" title="Event that the amp should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_AMP_ON</a>);
<a name="l00143"></a>00143                                 }
<a name="l00144"></a>00144                                 
<a name="l00145"></a>00145                                 <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#5fa1f5b6c64fa66ea64ddedcc2059fbc" title="Flags on which sequencer variables that are enabled.">active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#4ecfaca15b56017b6b8b24ed0e2bdb95" title="Sequencer enabled for RADIO.">SEQUENCER_PTT_RADIO_ENABLED</a>)) {
<a name="l00146"></a>00146                                         <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#ccffdcb09e8fc6a32df02fe22268f774" title="Activate the radio PTT.">radio_ptt_active</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#702e757af8539ea1b50591e2cc00b799" title="The delay before the radio is PTTed after the input PTT has been activated.">radio_pre_delay</a> * 10, <a class="code" href="sequencer_8h.html#f38759260db765aa98a8036725db06cd" title="Event that the radio should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_RADIO_ON</a>);
<a name="l00147"></a>00147                                 }
<a name="l00148"></a>00148                                 
<a name="l00149"></a>00149                                 <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#5fa1f5b6c64fa66ea64ddedcc2059fbc" title="Flags on which sequencer variables that are enabled.">active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#96aeef2285686486d8093a8a475679be" title="Sequencer enabled for INHIBIT.">SEQUENCER_PTT_INHIBIT_ENABLED</a>)) {
<a name="l00150"></a>00150                                         <span class="keywordflow">if</span> ((ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#eebdfa78b7e9c83edc88a73337fe55d7" title="Flag bit offset for the inhibit polarity.">PTT_INPUT_INHIBIT_POLARITY</a>)) == 0)   {
<a name="l00151"></a>00151                                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#10509297dec3040da555bc74e07dee04" title="Set the inhibit signal to low.">radio_inhibit_low</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#239dddd85cd4a89a9fdbc2653fbcacd1" title="The delay before the inhibit is activated after the input PTT has been activated...">inhibit_pre_delay</a> * 10, <a class="code" href="sequencer_8h.html#d25126250cfc3462e8b59308fc6f2a0d" title="Event that the inhibit output should be on.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_ON</a>);
<a name="l00152"></a>00152                                         }
<a name="l00153"></a>00153                                         <span class="keywordflow">else</span> {
<a name="l00154"></a>00154                                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#ac6dcfef06b5c2f9bb8913b780889758" title="Set the inhibit signal to high.">radio_inhibit_high</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#239dddd85cd4a89a9fdbc2653fbcacd1" title="The delay before the inhibit is activated after the input PTT has been activated...">inhibit_pre_delay</a> * 10, <a class="code" href="sequencer_8h.html#d25126250cfc3462e8b59308fc6f2a0d" title="Event that the inhibit output should be on.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_ON</a>);
<a name="l00155"></a>00155                                         }
<a name="l00156"></a>00156                                 }
<a name="l00157"></a>00157                                 
<a name="l00158"></a>00158                                 <span class="comment">//Show that the PTT is (also) activated by the computer now</span>
<a name="l00159"></a>00159                                 <a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a> |= (1&lt;&lt;<a class="code" href="sequencer_8c.html#7f794cc4a66dade4c3a970c75ad2362e" title="The computer PTT input is active.">PTT_ACTIVE_COMPUTER_RTS</a>);
<a name="l00160"></a>00160                         }
<a name="l00161"></a>00161                 }
<a name="l00162"></a>00162         }
<a name="l00163"></a>00163 }
<a name="l00164"></a>00164 
<a name="l00166"></a><a class="code" href="sequencer_8h.html#2083ed0682dc10e08b34165e621b8ffb">00166</a> <span class="keywordtype">void</span> <a class="code" href="sequencer_8c.html#2083ed0682dc10e08b34165e621b8ffb" title="Function to be called if the computer rts is deactivated.">sequencer_computer_rts_deactivated</a>(<span class="keywordtype">void</span>) {
<a name="l00167"></a>00167         <span class="comment">//Check if the footswitch input is enabled</span>
<a name="l00168"></a>00168         <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#fa21a420a829c483647804e3bbc1803f" title="Flag bit offset for the COMPUTER RTS signal.">PTT_INPUT_COMPUTER_RTS</a>)) {
<a name="l00169"></a>00169                 <span class="comment">//If the footswitch does PTT, we cannot stop the sequence, the footswitch will</span>
<a name="l00170"></a>00170                 <span class="keywordflow">if</span> (((ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#0a2333714aea2d77855a876b472a3ab3" title="Flag bit offset for the footswitch.">PTT_INPUT_FOOTSWITCH</a>)) &amp;&amp; ((<a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8c.html#297ab6ae481decc5b654b11033b61a5d" title="The footswitch PTT input is active.">PTT_ACTIVE_FOOTSWITCH</a>)) == 0)) || (ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#0a2333714aea2d77855a876b472a3ab3" title="Flag bit offset for the footswitch.">PTT_INPUT_FOOTSWITCH</a>)) == 0) {
<a name="l00171"></a>00171                         <span class="comment">//Checks so that the footswitch wasn't relased premature, if it was, we drop the message to PTT the radio or amp</span>
<a name="l00172"></a>00172                         <span class="comment">//That way if we accidentally press the footswitch shortly we don't need to go through the sequencer cycle if the</span>
<a name="l00173"></a>00173                         <span class="comment">//delays are longer than the footswitch was pressed (not very likely though)</span>
<a name="l00174"></a>00174                         <span class="keywordflow">if</span> (<a class="code" href="event__queue_8c.html#bf734c18b872c4ecc29108b083cc2a36" title="Drops all messages in the queue with a certain ID.">event_queue_drop_id</a>(<a class="code" href="sequencer_8h.html#f38759260db765aa98a8036725db06cd" title="Event that the radio should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_RADIO_ON</a>) == 0) {
<a name="l00175"></a>00175                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#282c423a5968304bf393977e2aca1468" title="Deactivate the radio PTT.">radio_ptt_deactive</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#b4f538805dcedc5be55360eed1de886b" title="The delay after the input PTT has been released and the radio PTT is released.">radio_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#7a371779f225b2ecf366d5f30192ab1f" title="Event that the radio should be deactivated from footswitch.">SEQUENCER_EVENT_TYPE_PTT_RADIO_OFF</a>);
<a name="l00176"></a>00176                         }
<a name="l00177"></a>00177                                 
<a name="l00178"></a>00178                         <span class="keywordflow">if</span> (<a class="code" href="event__queue_8c.html#bf734c18b872c4ecc29108b083cc2a36" title="Drops all messages in the queue with a certain ID.">event_queue_drop_id</a>(<a class="code" href="sequencer_8h.html#f5a386f4adf5a932b756b540b8f6be79" title="Event that the amp should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_AMP_ON</a>) == 0) {
<a name="l00179"></a>00179                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#c317b76e083257d47fe444dc9a3e8a46" title="Deactivate PTT amp.">radio_amp_ptt_deactive</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#722cda497689fc4fe50d0e6c15e6726e" title="The delay after the input PTT has been released and the amp PTT is released.">amp_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#ece8368b679b708e800b2ae3b20628c6" title="Event that the amp should be deactivated from footswitch.">SEQUENCER_EVENT_TYPE_PTT_AMP_OFF</a>);
<a name="l00180"></a>00180                         }
<a name="l00181"></a>00181         
<a name="l00182"></a>00182                         <span class="keywordflow">if</span> (<a class="code" href="event__queue_8c.html#bf734c18b872c4ecc29108b083cc2a36" title="Drops all messages in the queue with a certain ID.">event_queue_drop_id</a>(<a class="code" href="sequencer_8h.html#aae40a289cf630e5a9f47e737ee7752e" title="Event that the radio should be PTT:ed from footswitch.">SEQUENCER_EVENT_TYPE_PTT_TX_ACTIVE_ON</a>) == 0) {
<a name="l00183"></a>00183                                 <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#eb4c7b45ff52decc8cd6da2666f8f88e" title="Set the TX ACTIVE output to high.">radio_tx_deactive</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#d35cc48fb05bb8c1da7c8e19759d2066" title="The delay after theinput PTT has been released and the antennas are switched.">antennas_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#6a89977d20bdd32f477dde7646f0ca8f" title="Event that the inhibit should be activated from footswitch.">SEQUENCER_EVENT_TYPE_PTT_TX_ACTIVE_OFF</a>);
<a name="l00184"></a>00184                         }
<a name="l00185"></a>00185                         
<a name="l00186"></a>00186                         <span class="keywordflow">if</span> (<a class="code" href="event__queue_8c.html#bf734c18b872c4ecc29108b083cc2a36" title="Drops all messages in the queue with a certain ID.">event_queue_drop_id</a>(<a class="code" href="sequencer_8h.html#d25126250cfc3462e8b59308fc6f2a0d" title="Event that the inhibit output should be on.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_ON</a>) == 0) {
<a name="l00187"></a>00187                                 <span class="keywordflow">if</span> ((ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#eebdfa78b7e9c83edc88a73337fe55d7" title="Flag bit offset for the inhibit polarity.">PTT_INPUT_INHIBIT_POLARITY</a>)) == 0)   <span class="comment">//Inhibit polarity = active low</span>
<a name="l00188"></a>00188                                         <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#ac6dcfef06b5c2f9bb8913b780889758" title="Set the inhibit signal to high.">radio_inhibit_high</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#919ecd74b5a2275ad15bc79f28cf2e8d" title="The delay after the input PTT has been released and the inhibit pin is released.">inhibit_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#765792034f6c1607059edeac24354bf2" title="Event that the TX active output should be off.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_OFF</a>);
<a name="l00189"></a>00189                                 <span class="keywordflow">else</span>
<a name="l00190"></a>00190                                         <a class="code" href="front__panel_2main_8c.html#f496e941a90c0dab928b545c26d30dcc">event_add_message</a>((<span class="keywordtype">void</span> *)<a class="code" href="radio__interface_8c.html#10509297dec3040da555bc74e07dee04" title="Set the inhibit signal to low.">radio_inhibit_low</a>, ptt_sequencer.<a class="code" href="structstruct__ptt.html#bb93f1272d80233f433b49b052316774" title="The PTT SEQUENCER for the computer input.">computer</a>.<a class="code" href="structstruct__ptt__sequencer.html#919ecd74b5a2275ad15bc79f28cf2e8d" title="The delay after the input PTT has been released and the inhibit pin is released.">inhibit_post_delay</a> * 10, <a class="code" href="sequencer_8h.html#765792034f6c1607059edeac24354bf2" title="Event that the TX active output should be off.">SEQUENCER_EVENT_TYPE_PTT_INHIBIT_OFF</a>);
<a name="l00191"></a>00191                         }
<a name="l00192"></a>00192                 }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194                 <a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a> &amp;= ~(1&lt;&lt;<a class="code" href="sequencer_8c.html#7f794cc4a66dade4c3a970c75ad2362e" title="The computer PTT input is active.">PTT_ACTIVE_COMPUTER_RTS</a>);
<a name="l00195"></a>00195         }
<a name="l00196"></a>00196 }
<a name="l00197"></a>00197 
<a name="l00199"></a><a class="code" href="sequencer_8h.html#558af8a3cc03524c519865da8c52e94d">00199</a> <span class="keywordtype">void</span> <a class="code" href="sequencer_8c.html#558af8a3cc03524c519865da8c52e94d" title="Function to be called if the radio sense input is activated.">sequencer_radio_sense_activated</a>(<span class="keywordtype">void</span>) {
<a name="l00200"></a>00200         printf(<span class="stringliteral">"RADIO_SENSE_ACTIVE\n"</span>);
<a name="l00201"></a>00201 }
<a name="l00202"></a>00202 
<a name="l00204"></a><a class="code" href="sequencer_8h.html#2d3a0f37732079072955fc9397fccae8">00204</a> <span class="keywordtype">void</span> <a class="code" href="sequencer_8c.html#2d3a0f37732079072955fc9397fccae8" title="Function to be called if the radio sense input is deactivated.">sequencer_radio_sense_deactivated</a>(<span class="keywordtype">void</span>) {
<a name="l00205"></a>00205         printf(<span class="stringliteral">"RADIO_SENSE_DEACTIVE\n"</span>);
<a name="l00206"></a>00206 }
<a name="l00207"></a>00207 
<a name="l00210"></a><a class="code" href="sequencer_8h.html#0810a2f37dd0688f603cec15d4b2fd7d">00210</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="sequencer_8c.html#b818249c0d01c3158c9ac4a980162e4e" title="Retrieve the polarity of the Computer RTS signal.">sequencer_get_rts_polarity</a>() {
<a name="l00211"></a>00211         <span class="keywordflow">if</span> (ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#f449c6d38de6e016356a45fa0e2ea380" title="Flag bit offset for an inverted computer rts signal.">PTT_INPUT_INVERTED_COMPUTER_RTS</a>))
<a name="l00212"></a>00212                 <span class="keywordflow">return</span>(0);
<a name="l00213"></a>00213         <span class="keywordflow">else</span>
<a name="l00214"></a>00214                 <span class="keywordflow">return</span>(1);
<a name="l00215"></a>00215 }
<a name="l00216"></a>00216 
<a name="l00219"></a><a class="code" href="sequencer_8h.html#a0bf8e67faeaaa623abc17be9ad9371d">00219</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="sequencer_8c.html#82395bc82dfd38aac92240d8a4035241" title="Retrieve the polarity of the radio sense signal.">sequencer_get_sense_polarity</a>() {
<a name="l00220"></a>00220         <span class="keywordflow">return</span>(ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#4c13802d0307a01c3f6936ed794f8d3b" title="Flag bit offset for an inverted radio sense signal.">PTT_INPUT_INVERTED_RADIO_SENSE</a>));
<a name="l00221"></a>00221 }
<a name="l00222"></a>00222 
<a name="l00225"></a><a class="code" href="sequencer_8h.html#bd5428803147cbe9960a82d9e6e7dce6">00225</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="sequencer_8c.html#bd5428803147cbe9960a82d9e6e7dce6" title="Will return if the PTT is active or not.">sequencer_ptt_active</a>(<span class="keywordtype">void</span>) {
<a name="l00226"></a>00226         <span class="keywordflow">return</span>(<a class="code" href="sequencer_8c.html#339ca62dcc7f2ddaddcc68541f5c9a61" title="The status of the PTT, see defines above.">ptt_active</a>);
<a name="l00227"></a>00227 }
<a name="l00228"></a>00228 
<a name="l00231"></a><a class="code" href="sequencer_8h.html#989542be4592763f28295ccc7fe8db3c">00231</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="sequencer_8c.html#989542be4592763f28295ccc7fe8db3c" title="Retrieve if the radio sense should be sensed from upper floor or bottom.">sequencer_get_radio_sense</a>(<span class="keywordtype">void</span>) {
<a name="l00232"></a>00232         <span class="keywordflow">if</span> ((ptt_sequencer.<a class="code" href="structstruct__ptt.html#43c60729257a2cb42fc44af21e394224">ptt_input</a> &amp; (1&lt;&lt;<a class="code" href="sequencer_8h.html#6f0d4d0c159fa58e95792decb825576c" title="Flag bit offset for the radio sense on the upper floor.">PTT_INPUT_RADIO_SENSE_UP</a>)) != 0)
<a name="l00233"></a>00233                 <span class="keywordflow">return</span>(1);
<a name="l00234"></a>00234         <span class="keywordflow">else</span>
<a name="l00235"></a>00235                 <span class="keywordflow">return</span>(0);
<a name="l00236"></a>00236 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 19 20:56:57 2010 for uC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
