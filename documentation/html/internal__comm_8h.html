<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>uC: internal_comm.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>internal_comm.h File Reference</h1>The internal communication routines.  
<a href="#_details">More...</a>
<p>

<p>
<a href="internal__comm_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structstruct__uc__com.html">struct_uc_com</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#553542544a54f597b3d2d2704a76cb2b">UC_PREAMBLE_FOUND</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">if the device is a motherboard we need to set the proper USARTs used  <a href="#553542544a54f597b3d2d2704a76cb2b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6692f97fb35052c105fd1b57dc7005c6"></a><!-- doxytag: member="internal_comm.h::UC_MESSAGE_IN_BUFFER" ref="6692f97fb35052c105fd1b57dc7005c6" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#6692f97fb35052c105fd1b57dc7005c6">UC_MESSAGE_IN_BUFFER</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flag that a message is in the buffer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5707c99c71e5dd832214868c2e75634f"></a><!-- doxytag: member="internal_comm.h::UC_SIZE_FIXED" ref="5707c99c71e5dd832214868c2e75634f" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#5707c99c71e5dd832214868c2e75634f">UC_SIZE_FIXED</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of UC MESSAGE fixed part. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#88cf69a74b6779dcf408122fccf68854">UC_COMM_MSG_PREAMBLE</a>&nbsp;&nbsp;&nbsp;0xFE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#ebc23a7b60db897e42de4784ccbe4511">UC_COMM_MSG_POSTAMBLE</a>&nbsp;&nbsp;&nbsp;0xFD</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#dc1bd2e9a631be9894ccad2619eb72ca">UC_COMM_MSG_ACK</a>&nbsp;&nbsp;&nbsp;0xFB</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#2351b56552be2678354ae365881b62e0">UC_COMM_MSG_NACK</a>&nbsp;&nbsp;&nbsp;0xFA</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7c597134822ccbcee08bf0c8ca24929d"></a><!-- doxytag: member="internal_comm.h::UC_SERIAL_RX_BUFFER_LENGTH" ref="7c597134822ccbcee08bf0c8ca24929d" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#7c597134822ccbcee08bf0c8ca24929d">UC_SERIAL_RX_BUFFER_LENGTH</a>&nbsp;&nbsp;&nbsp;20</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The length of the serial rx buffer used for communication between the uCs. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="579bfb56bf1877f1a43cc183e966f309"></a><!-- doxytag: member="internal_comm.h::UC_MESSAGE_DATA_SIZE" ref="579bfb56bf1877f1a43cc183e966f309" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#579bfb56bf1877f1a43cc183e966f309">UC_MESSAGE_DATA_SIZE</a>&nbsp;&nbsp;&nbsp;15</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The size the data sent between the two devices can be maximum. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="32e7159be7cf3dbd975495b32dbe1135"></a><!-- doxytag: member="internal_comm.h::UC_COMM_RX_TIMEOUT" ref="32e7159be7cf3dbd975495b32dbe1135" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#32e7159be7cf3dbd975495b32dbe1135">UC_COMM_RX_TIMEOUT</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">After this many ms it will reset the rx flags (in ms). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="87493b6d3503b0344548836ad9ee9878"></a><!-- doxytag: member="internal_comm.h::UC_COMM_TX_TIMEOUT" ref="87493b6d3503b0344548836ad9ee9878" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#87493b6d3503b0344548836ad9ee9878">UC_COMM_TX_TIMEOUT</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">After this many ms a resend will occur if a message has not been acked (in ms). <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="290343a67067544540f528c90bb05814"></a><!-- doxytag: member="internal_comm.h::UC_COMM_RESEND_COUNT" ref="290343a67067544540f528c90bb05814" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#290343a67067544540f528c90bb05814">UC_COMM_RESEND_COUNT</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of resends that is allowed. <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#038459fe5d58ddbde1ed8459d3b9bbce">internal_comm_init</a> (void(*func_ptr_rx)(<a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a>), void(*func_ptr_tx)(char))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize the internal communication.  <a href="#038459fe5d58ddbde1ed8459d3b9bbce"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#64c4f318386e5cad700f6c5e08677c6f">internal_comm_poll_rx_queue</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Polls the RX queue in the internal communication and calls the function defined in internal_comm_init.  <a href="#64c4f318386e5cad700f6c5e08677c6f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#35f8e503f80c8e1188ad09c1c0dde6ec">internal_comm_poll_tx_queue</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Polls the TX queue in the internal communication and sends the data if there is a message in the queue.  <a href="#35f8e503f80c8e1188ad09c1c0dde6ec"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#d9191f782631f96ebe7a5d9d846ba97b">internal_comm_add_tx_message</a> (unsigned char command, unsigned char length, char *data)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a message to the transmit queue.  <a href="#d9191f782631f96ebe7a5d9d846ba97b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="fbadb98b60aabeefe61ca1d21ec183db"></a><!-- doxytag: member="internal_comm.h::internal_comm_send_ack" ref="fbadb98b60aabeefe61ca1d21ec183db" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#fbadb98b60aabeefe61ca1d21ec183db">internal_comm_send_ack</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an ACK message to the internal communication uart. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="17a9a942903f42bd140b2cd0e2486161"></a><!-- doxytag: member="internal_comm.h::internal_comm_send_nack" ref="17a9a942903f42bd140b2cd0e2486161" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#17a9a942903f42bd140b2cd0e2486161">internal_comm_send_nack</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a NACK message to the internal communication uart. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#b19320006eb32811d9c211f41e229f87">internal_comm_send_message</a> (<a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a> tx_message)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a message to the internal communication uart.  <a href="#b19320006eb32811d9c211f41e229f87"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7db36f8f06871f98ad2effe0484aaacb"></a><!-- doxytag: member="internal_comm.h::internal_comm_reset_rx" ref="7db36f8f06871f98ad2effe0484aaacb" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#7db36f8f06871f98ad2effe0484aaacb">internal_comm_reset_rx</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Will reset the RX variables. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bfbe070c4b84a6b49bbf3db2a1d2e98d"></a><!-- doxytag: member="internal_comm.h::internal_comm_1ms_timer" ref="bfbe070c4b84a6b49bbf3db2a1d2e98d" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#bfbe070c4b84a6b49bbf3db2a1d2e98d">internal_comm_1ms_timer</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function which should be called each ms. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="37cb0731cb2b98770a5a67dfdd0303c6"></a><!-- doxytag: member="internal_comm.h::internal_comm_resend" ref="37cb0731cb2b98770a5a67dfdd0303c6" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="internal__comm_8h.html#37cb0731cb2b98770a5a67dfdd0303c6">internal_comm_resend</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Will trigger a resend of the last message. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The internal communication routines. 
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Mikael Larsmark, SM2WMV </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-01-25 <div class="fragment"><pre class="fragment"><span class="preprocessor"> #include "<a class="code" href="internal__comm_8h.html" title="The internal communication routines.">internal_comm.h</a>"</span> 
</pre></div> </dd></dl>

<p>Definition in file <a class="el" href="internal__comm_8h-source.html">internal_comm.h</a>.</p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="dc1bd2e9a631be9894ccad2619eb72ca"></a><!-- doxytag: member="internal_comm.h::UC_COMM_MSG_ACK" ref="dc1bd2e9a631be9894ccad2619eb72ca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UC_COMM_MSG_ACK&nbsp;&nbsp;&nbsp;0xFB          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The acknowledge command of the bus 
<p>Definition at line <a class="el" href="internal__comm_8h-source.html#l00073">73</a> of file <a class="el" href="internal__comm_8h-source.html">internal_comm.h</a>.</p>

<p>Referenced by <a class="el" href="internal__comm_8c-source.html#l00118">internal_comm_send_ack()</a>, and <a class="el" href="internal__comm_8c-source.html#l00201">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2351b56552be2678354ae365881b62e0"></a><!-- doxytag: member="internal_comm.h::UC_COMM_MSG_NACK" ref="2351b56552be2678354ae365881b62e0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UC_COMM_MSG_NACK&nbsp;&nbsp;&nbsp;0xFA          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The NOT acknowledge command of the bus 
<p>Definition at line <a class="el" href="internal__comm_8h-source.html#l00075">75</a> of file <a class="el" href="internal__comm_8h-source.html">internal_comm.h</a>.</p>

<p>Referenced by <a class="el" href="internal__comm_8c-source.html#l00132">internal_comm_send_nack()</a>, and <a class="el" href="internal__comm_8c-source.html#l00201">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ebc23a7b60db897e42de4784ccbe4511"></a><!-- doxytag: member="internal_comm.h::UC_COMM_MSG_POSTAMBLE" ref="ebc23a7b60db897e42de4784ccbe4511" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UC_COMM_MSG_POSTAMBLE&nbsp;&nbsp;&nbsp;0xFD          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The postamble of the BUS message 
<p>Definition at line <a class="el" href="internal__comm_8h-source.html#l00071">71</a> of file <a class="el" href="internal__comm_8h-source.html">internal_comm.h</a>.</p>

<p>Referenced by <a class="el" href="internal__comm_8c-source.html#l00118">internal_comm_send_ack()</a>, <a class="el" href="internal__comm_8c-source.html#l00147">internal_comm_send_message()</a>, <a class="el" href="internal__comm_8c-source.html#l00132">internal_comm_send_nack()</a>, and <a class="el" href="internal__comm_8c-source.html#l00201">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="88cf69a74b6779dcf408122fccf68854"></a><!-- doxytag: member="internal_comm.h::UC_COMM_MSG_PREAMBLE" ref="88cf69a74b6779dcf408122fccf68854" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UC_COMM_MSG_PREAMBLE&nbsp;&nbsp;&nbsp;0xFE          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The preamble of the BUS message 
<p>Definition at line <a class="el" href="internal__comm_8h-source.html#l00069">69</a> of file <a class="el" href="internal__comm_8h-source.html">internal_comm.h</a>.</p>

<p>Referenced by <a class="el" href="internal__comm_8c-source.html#l00118">internal_comm_send_ack()</a>, <a class="el" href="internal__comm_8c-source.html#l00147">internal_comm_send_message()</a>, <a class="el" href="internal__comm_8c-source.html#l00132">internal_comm_send_nack()</a>, and <a class="el" href="internal__comm_8c-source.html#l00201">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="553542544a54f597b3d2d2704a76cb2b"></a><!-- doxytag: member="internal_comm.h::UC_PREAMBLE_FOUND" ref="553542544a54f597b3d2d2704a76cb2b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UC_PREAMBLE_FOUND&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
if the device is a motherboard we need to set the proper USARTs used 
<p>
if the device is a frontpanel we need to set the proper USARTs used Preamble found for the communication between the uCs 
<p>Definition at line <a class="el" href="internal__comm_8h-source.html#l00061">61</a> of file <a class="el" href="internal__comm_8h-source.html">internal_comm.h</a>.</p>

<p>Referenced by <a class="el" href="internal__comm_8c-source.html#l00201">ISR()</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="d9191f782631f96ebe7a5d9d846ba97b"></a><!-- doxytag: member="internal_comm.h::internal_comm_add_tx_message" ref="d9191f782631f96ebe7a5d9d846ba97b" args="(unsigned char command, unsigned char length, char *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void internal_comm_add_tx_message           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>data</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a message to the transmit queue. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>command</em>&nbsp;</td><td>The command we wish to perform </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the data field </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>The data we wish to send </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00166">166</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm_8h-source.html#l00096">UC_MESSAGE::checksum</a>, <a class="el" href="internal__comm_8h-source.html#l00098">UC_MESSAGE::cmd</a>, <a class="el" href="internal__comm_8h-source.html#l00102">UC_MESSAGE::data</a>, <a class="el" href="internal__comm__tx__queue_8c-source.html#l00043">int_comm_tx_queue_add()</a>, and <a class="el" href="internal__comm_8h-source.html#l00100">UC_MESSAGE::length</a>.</p>

<p>Referenced by <a class="el" href="antenna__ctrl_8c-source.html#l00121">antenna_ctrl_deactivate_outputs()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00139">antenna_ctrl_send_ant_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00231">antenna_ctrl_send_rx_ant_band_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00189">antenna_ctrl_send_rx_ant_data_to_bus()</a>, <a class="el" href="band__ctrl_8c-source.html#l00053">band_ctrl_send_band_data_to_bus()</a>, <a class="el" href="motherboard_2computer__interface_8c-source.html#l00175">computer_interface_parse_data()</a>, <a class="el" href="motherboard_2main_8c-source.html#l00306">main()</a>, <a class="el" href="motherboard_2main_8c-source.html#l00154">parse_internal_comm_message()</a>, <a class="el" href="motherboard_2main_8c-source.html#l00301">ps2_process_key()</a>, <a class="el" href="radio__interface_8c-source.html#l00205">radio_poll_status()</a>, <a class="el" href="front__panel_2main_8c-source.html#l00161">shutdown_device()</a>, and <a class="el" href="sub__menu_8c-source.html#l00144">sub_menu_send_data_to_bus()</a>.</p>

</div>
</div><p>
<a class="anchor" name="038459fe5d58ddbde1ed8459d3b9bbce"></a><!-- doxytag: member="internal_comm.h::internal_comm_init" ref="038459fe5d58ddbde1ed8459d3b9bbce" args="(void(*func_ptr_rx)(UC_MESSAGE), void(*func_ptr_tx)(char))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void internal_comm_init           </td>
          <td>(</td>
          <td class="paramtype">void(*)(<a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a>)&nbsp;</td>
          <td class="paramname"> <em>func_ptr_rx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(char)&nbsp;</td>
          <td class="paramname"> <em>func_ptr_tx</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initialize the internal communication. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>func_ptr_rx</em>&nbsp;</td><td>The function you wish to call when a new message has been recieved and should be parsed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>func_ptr_tx</em>&nbsp;</td><td>The function used to send data to the hardware handeling the data transmission </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00068">68</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm_8h-source.html#l00112">struct_uc_com::char_count</a>, <a class="el" href="internal__comm_8h-source.html#l00110">struct_uc_com::checksum</a>, <a class="el" href="internal__comm_8c.html#1bb3b57523849b2a6507039940dc7495">f_ptr_rx</a>, <a class="el" href="internal__comm_8c.html#733ad7cf6722dfbf0c368f8e39a2cce7">f_ptr_tx</a>, <a class="el" href="internal__comm_8h-source.html#l00108">struct_uc_com::flags</a>, <a class="el" href="internal__comm__rx__queue_8c-source.html#l00076">int_comm_rx_queue_dropall()</a>, and <a class="el" href="internal__comm__tx__queue_8c-source.html#l00076">int_comm_tx_queue_dropall()</a>.</p>

<p>Referenced by <a class="el" href="front__panel_2main_8c-source.html#l00293">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="64c4f318386e5cad700f6c5e08677c6f"></a><!-- doxytag: member="internal_comm.h::internal_comm_poll_rx_queue" ref="64c4f318386e5cad700f6c5e08677c6f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char internal_comm_poll_rx_queue           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Polls the RX queue in the internal communication and calls the function defined in internal_comm_init. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>1 if a message was in the buffer and got parsed, 0 if not </dd></dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00091">91</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm_8c.html#1bb3b57523849b2a6507039940dc7495">f_ptr_rx</a>, <a class="el" href="internal__comm__rx__queue_8c-source.html#l00066">int_comm_rx_queue_drop()</a>, <a class="el" href="internal__comm__rx__queue_8c-source.html#l00059">int_comm_rx_queue_get()</a>, and <a class="el" href="internal__comm__rx__queue_8c-source.html#l00084">int_comm_rx_queue_is_empty()</a>.</p>

<p>Referenced by <a class="el" href="front__panel_2main_8c-source.html#l00293">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="35f8e503f80c8e1188ad09c1c0dde6ec"></a><!-- doxytag: member="internal_comm.h::internal_comm_poll_tx_queue" ref="35f8e503f80c8e1188ad09c1c0dde6ec" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char internal_comm_poll_tx_queue           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Polls the TX queue in the internal communication and sends the data if there is a message in the queue. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>1 if a message was in the buffer and got sent, 0 if not </dd></dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00105">105</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm__tx__queue_8c-source.html#l00059">int_comm_tx_queue_get()</a>, <a class="el" href="internal__comm__tx__queue_8c-source.html#l00084">int_comm_tx_queue_is_empty()</a>, <a class="el" href="internal__comm_8c-source.html#l00147">internal_comm_send_message()</a>, and <a class="el" href="internal__comm_8c-source.html#l00058">msg_not_acked</a>.</p>

<p>Referenced by <a class="el" href="front__panel_2main_8c-source.html#l00293">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="b19320006eb32811d9c211f41e229f87"></a><!-- doxytag: member="internal_comm.h::internal_comm_send_message" ref="b19320006eb32811d9c211f41e229f87" args="(UC_MESSAGE tx_message)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void internal_comm_send_message           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structUC__MESSAGE.html">UC_MESSAGE</a>&nbsp;</td>
          <td class="paramname"> <em>tx_message</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a message to the internal communication uart. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tx_message</em>&nbsp;</td><td>The message we wish to send </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="internal__comm_8c-source.html#l00147">147</a> of file <a class="el" href="internal__comm_8c-source.html">internal_comm.c</a>.</p>

<p>References <a class="el" href="internal__comm_8h-source.html#l00096">UC_MESSAGE::checksum</a>, <a class="el" href="internal__comm_8h-source.html#l00098">UC_MESSAGE::cmd</a>, <a class="el" href="internal__comm_8c-source.html#l00050">counter_tx_timeout</a>, <a class="el" href="internal__comm_8h-source.html#l00102">UC_MESSAGE::data</a>, <a class="el" href="internal__comm_8c.html#733ad7cf6722dfbf0c368f8e39a2cce7">f_ptr_tx</a>, <a class="el" href="internal__comm_8h-source.html#l00100">UC_MESSAGE::length</a>, <a class="el" href="internal__comm_8h-source.html#l00071">UC_COMM_MSG_POSTAMBLE</a>, and <a class="el" href="internal__comm_8h-source.html#l00069">UC_COMM_MSG_PREAMBLE</a>.</p>

<p>Referenced by <a class="el" href="internal__comm_8c-source.html#l00105">internal_comm_poll_tx_queue()</a>, and <a class="el" href="internal__comm_8c-source.html#l00183">internal_comm_resend()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 19 20:56:58 2010 for uC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
