<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>uC: wmv_bus/bus.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>wmv_bus/bus.h File Reference</h1>The communication bus protocol used in the openASC project.  
<a href="#_details">More...</a>
<p>

<p>
<a href="bus_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structBUS__MESSAGE.html">BUS_MESSAGE</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrx__linked__list.html">rx_linked_list</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The structure of the RX circular buffer.  <a href="structrx__linked__list.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structtx__linked__list.html">tx_linked_list</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The structure of the TX circular buffer.  <a href="structtx__linked__list.html#_details">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbus__status__struct.html">bus_status_struct</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#14379db1c0e7d2b141c5c79b654046fa">DEF_NR_DEVICES</a>&nbsp;&nbsp;&nbsp;25</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define the proper interrupt routines depending on hardware.  <a href="#14379db1c0e7d2b141c5c79b654046fa"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6d14e83bdbd2c140169665ded6befffd"></a><!-- doxytag: member="bus.h::DEFAULT_STARTUP_DELAY" ref="6d14e83bdbd2c140169665ded6befffd" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#6d14e83bdbd2c140169665ded6befffd">DEFAULT_STARTUP_DELAY</a>&nbsp;&nbsp;&nbsp;90</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The startup time for the device. This is so that all units dont send ping at the same time. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#745f0f43205404fd4fb90176db54da84">BUS_MSG_PREAMBLE</a>&nbsp;&nbsp;&nbsp;0xFE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#837db7e8a269db9d24d01d5d2f20f666">BUS_MSG_POSTAMBLE</a>&nbsp;&nbsp;&nbsp;0xFD</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#d5963e8d59fa0adb58ed714382363577">BUS_MSG_ACK</a>&nbsp;&nbsp;&nbsp;0xFA</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#aa67432524edc62d9a071161984c8167">BUS_MSG_NACK</a>&nbsp;&nbsp;&nbsp;0xFB</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#6249520d08d6d922ac9c4f2ce86427e6">BUS_BROADCAST_ADDR</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="63462d2a163fc2856a91a4ed6feb275e"></a><!-- doxytag: member="bus.h::DEVICE_ID_MAINBOX" ref="63462d2a163fc2856a91a4ed6feb275e" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#63462d2a163fc2856a91a4ed6feb275e">DEVICE_ID_MAINBOX</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device ID for the mainbox. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="8b52fe22425a13f9344f6d85903a0540"></a><!-- doxytag: member="bus.h::DEVICE_ID_DRIVER_POS" ref="8b52fe22425a13f9344f6d85903a0540" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#8b52fe22425a13f9344f6d85903a0540">DEVICE_ID_DRIVER_POS</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device ID for the positive driver module. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1ac051e1399e4c2f7db8fcdcdd3ad197"></a><!-- doxytag: member="bus.h::DEVICE_ID_DRIVER_NEG" ref="1ac051e1399e4c2f7db8fcdcdd3ad197" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#1ac051e1399e4c2f7db8fcdcdd3ad197">DEVICE_ID_DRIVER_NEG</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device ID for the negative driver module. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b695a1867f19a15b9a0c59bef13a81ac"></a><!-- doxytag: member="bus.h::DEVICE_ID_ROTATOR_UNIT" ref="b695a1867f19a15b9a0c59bef13a81ac" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#b695a1867f19a15b9a0c59bef13a81ac">DEVICE_ID_ROTATOR_UNIT</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device ID for the rotator unit. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c0ea409622c3bc3c8e7de55325d6e6e8"></a><!-- doxytag: member="bus.h::DEVICE_ID_COMPUTER" ref="c0ea409622c3bc3c8e7de55325d6e6e8" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#c0ea409622c3bc3c8e7de55325d6e6e8">DEVICE_ID_COMPUTER</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device ID for a computer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="847c4f6a6e898333397c83acabef562f"></a><!-- doxytag: member="bus.h::DEVICE_ID_POWERMETER_PICKUP" ref="847c4f6a6e898333397c83acabef562f" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#847c4f6a6e898333397c83acabef562f">DEVICE_ID_POWERMETER_PICKUP</a>&nbsp;&nbsp;&nbsp;6</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device ID for a power meter pickup. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5ebed536e93fff07b766b6390296c8bc"></a><!-- doxytag: member="bus.h::DEVICE_ID_GENERAL_IO" ref="5ebed536e93fff07b766b6390296c8bc" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#5ebed536e93fff07b766b6390296c8bc">DEVICE_ID_GENERAL_IO</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device ID for the General I/O card. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#a5a11702bff91f1a9e630f6b40953f3a">BUS_MAX_RESENDS</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#f21521f2eb3f795fc45cd827290c18ff">BUS_DEVICE_STATUS_MESSAGE_INTERVAL</a>&nbsp;&nbsp;&nbsp;1500</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#c6fbbe2929d0958f44d99a73f4055591">BUS_MASTER_SYNC_INTERVAL</a>&nbsp;&nbsp;&nbsp;1000</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#8254b281c8987922cd11d6ddd74fca6a">BUS_SYNC_TIMEOUT_LIMIT</a>&nbsp;&nbsp;&nbsp;3200</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#8045bc91156a876275574105a3040d6e">BUS_ACK_WRAPAROUND_LIMIT</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#01a619776878e68496fac136cae92e3b">BUS_TIMEOUT_LIMIT</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#e053fff2a62fe9f1db3ade6114954f79">BUS_STATUS_DEVICE_IS_MASTER_BIT</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#ce9e759febab1ef55a06836baff54dcb">BUS_STATUS_ALLOWED_TO_SEND_BIT</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#6a16221d27bb7882638936437408b9fa">BUS_STATUS_PREAMBLE_FOUND_BIT</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#07ac20bb9da5a0d2178ade0e7e2a1055">BUS_STATUS_MASTER_SENT_SYNC_BIT</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#d929cddec5866e51ae46f2b1146a3a0a">BUS_STATUS_TIME_SLOT_ACTIVE</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#ad5b06797adce7aad2eae7d9fa070bc7">BUS_STATUS_SEND_MESSAGE</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#35bd108336fd649fd8e73a4e9c4a00d6">BUS_STATUS_SEND_ACTIVE</a>&nbsp;&nbsp;&nbsp;6</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#6305d4de08e065ad7a9851ee739c554c">BUS_STATUS_RECEIVE_ON</a>&nbsp;&nbsp;&nbsp;7</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#716f8bf40ec0a741389c83fbe7a36b25">BUS_STATUS_FORCE_SYNC</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#079d5caf6326a9b8c706e34790c67a4d">BUS_STATUS_MESSAGE_ACK_TIMEOUT</a>&nbsp;&nbsp;&nbsp;9</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#550ae920e5b20b393e223b9af411d9f9">BUS_TIME_MULTIPLIER</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#81e5cc7dd49cfdc283046c4c19da3423">BUS_TIME_INTERRUPT_INTERVAL</a>&nbsp;&nbsp;&nbsp;130</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#ee2d8d588aab76ec47e5a7819b5dd99d">BUS_TIME_FRAME_LIMIT</a>&nbsp;&nbsp;&nbsp;520</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#3075ee8ff81a9a49b479684c40161fe4">BUS_SLOT_DEAD_TIME</a>&nbsp;&nbsp;&nbsp;130</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c9beb1901b37c4deeea22c09c6e8042b"></a><!-- doxytag: member="bus.h::SERIAL_RX_BUF_LENGTH" ref="c9beb1901b37c4deeea22c09c6e8042b" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#c9beb1901b37c4deeea22c09c6e8042b">SERIAL_RX_BUF_LENGTH</a>&nbsp;&nbsp;&nbsp;20</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Length of the RX buffer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="44c9bb9b0c95a00e1322c942aa7dca39"></a><!-- doxytag: member="bus.h::BUS_MESSAGE_DATA_SIZE" ref="44c9bb9b0c95a00e1322c942aa7dca39" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#44c9bb9b0c95a00e1322c942aa7dca39">BUS_MESSAGE_DATA_SIZE</a>&nbsp;&nbsp;&nbsp;15</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define the length of the bus message data field length. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#76bcceff22cba96905957274b8265298">BUS_MESSAGE_FLAGS_NEED_ACK</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d303c5913fdb4681de77bfd3a65064c6"></a><!-- doxytag: member="bus.h::BUS_CHECKSUM_ERROR" ref="d303c5913fdb4681de77bfd3a65064c6" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#d303c5913fdb4681de77bfd3a65064c6">BUS_CHECKSUM_ERROR</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">BUS ERRORs. <br></td></tr>
<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="bdfca8676e032bf7299a77bd89be379e"></a><!-- doxytag: member="bus.h::rx_queue_struct" ref="bdfca8676e032bf7299a77bd89be379e" args="" -->
typedef struct <a class="el" href="structrx__linked__list.html">rx_linked_list</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#bdfca8676e032bf7299a77bd89be379e">rx_queue_struct</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The structure of the RX circular buffer. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="02ede1cbaea86d95bfae901531bc9d67"></a><!-- doxytag: member="bus.h::tx_queue_struct" ref="02ede1cbaea86d95bfae901531bc9d67" args="" -->
typedef struct <a class="el" href="structtx__linked__list.html">tx_linked_list</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#02ede1cbaea86d95bfae901531bc9d67">tx_queue_struct</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The structure of the TX circular buffer. <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#4c78398b39ca1a317bcd94e32d3238ed">bus_add_tx_message</a> (unsigned char from_addr, unsigned char to_addr, unsigned char flags, unsigned char cmd, unsigned char length, unsigned char data[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a message to the TX queue which will be sent as soon as possible.  <a href="#4c78398b39ca1a317bcd94e32d3238ed"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#8900b6684889df452076e67b3a528bc8">bus_add_rx_message</a> (unsigned char from_addr, unsigned char to_addr, unsigned char flags, unsigned char cmd, unsigned char length, unsigned char data[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a message to the RX queue which will be sent as soon as possible.  <a href="#8900b6684889df452076e67b3a528bc8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#9869a6434da36c0bfa8573d68bed9b40">bus_set_address</a> (unsigned char addr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the address of this device on the bus.  <a href="#9869a6434da36c0bfa8573d68bed9b40"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#978d35e07c79199b121997d80de56655">bus_get_address</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the address of this device.  <a href="#978d35e07c79199b121997d80de56655"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="66e8708f99633602ea17873c9bed4b6d"></a><!-- doxytag: member="bus.h::bus_init" ref="66e8708f99633602ea17873c9bed4b6d" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#66e8708f99633602ea17873c9bed4b6d">bus_init</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Init the communication bus. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2e40ef066b1f7231f314bc85779110ed"></a><!-- doxytag: member="bus.h::bus_resend_message" ref="2e40ef066b1f7231f314bc85779110ed" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#2e40ef066b1f7231f314bc85779110ed">bus_resend_message</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resend the last message. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="069826b2c00193de5883c42ffc8c95fc"></a><!-- doxytag: member="bus.h::bus_send_ack" ref="069826b2c00193de5883c42ffc8c95fc" args="(unsigned char to_addr)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#069826b2c00193de5883c42ffc8c95fc">bus_send_ack</a> (unsigned char to_addr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an acknowledge. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#651be0f483dc1e17174069bbf991d653">bus_send_nack</a> (unsigned char to_addr, unsigned char error_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send an NOT acknowledge.  <a href="#651be0f483dc1e17174069bbf991d653"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="205fdad7d74dbd67e7b31c9630819cb9"></a><!-- doxytag: member="bus.h::bus_message_acked" ref="205fdad7d74dbd67e7b31c9630819cb9" args="(unsigned char addr)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#205fdad7d74dbd67e7b31c9630819cb9">bus_message_acked</a> (unsigned char addr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The message last sent was acknowledged from the receiver. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#4541ef9a75addac3aaa4af88d8f03590">bus_message_nacked</a> (unsigned char addr, unsigned char error_type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The message last sent was NACKED from the receiver.  <a href="#4541ef9a75addac3aaa4af88d8f03590"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="1f8ed281f15b4e6e34cdcdb2bfb70932"></a><!-- doxytag: member="bus.h::bus_reset_tx_status" ref="1f8ed281f15b4e6e34cdcdb2bfb70932" args="(void)" -->
void __inline__&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#1f8ed281f15b4e6e34cdcdb2bfb70932">bus_reset_tx_status</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function that resets the bus status variables. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="524ab9ee02e43dff455677fdecfb5e21"></a><!-- doxytag: member="bus.h::bus_reset_rx_status" ref="524ab9ee02e43dff455677fdecfb5e21" args="(void)" -->
void __inline__&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#524ab9ee02e43dff455677fdecfb5e21">bus_reset_rx_status</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Function that resets the bus status variables. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#ce52a77ee7a62558643de23c5f10f9c7">bus_is_master</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns if the bus is set to be master.  <a href="#ce52a77ee7a62558643de23c5f10f9c7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#ed493aabe32ac3eaafb77d4c23f15eb9">bus_set_is_master</a> (unsigned char state, unsigned char count)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the status if the device should be master or not.  <a href="#ed493aabe32ac3eaafb77d4c23f15eb9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#76f9639571632344a2a1ae4138663667">bus_get_device_count</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive the device count on the bus.  <a href="#76f9639571632344a2a1ae4138663667"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#bbcb4456ec66651e191189cc985bfeab">bus_set_device_count</a> (unsigned char <a class="el" href="front__panel_2main_8c.html#4e659bfe570f8e58593672bc9a8d22a7">device_count</a>)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the number of devices that are on the bus.  <a href="#bbcb4456ec66651e191189cc985bfeab"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#ceb215ff9ef4810ef00434c1c02f6a4c">bus_allowed_to_send</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns if you are allowed to transmit data to the bus or not.  <a href="#ceb215ff9ef4810ef00434c1c02f6a4c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="370f257e97b9adc5aeb57ef539ce8547"></a><!-- doxytag: member="bus.h::bus_check_tx_status" ref="370f257e97b9adc5aeb57ef539ce8547" args="(void)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="bus_8h.html#370f257e97b9adc5aeb57ef539ce8547">bus_check_tx_status</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if there is anything that should be sent in the TX queue. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The communication bus protocol used in the openASC project. 
<p>

<p>Definition in file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="8045bc91156a876275574105a3040d6e"></a><!-- doxytag: member="bus.h::BUS_ACK_WRAPAROUND_LIMIT" ref="8045bc91156a876275574105a3040d6e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_ACK_WRAPAROUND_LIMIT&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The timeout limit between a message that was sent to when it will be a resend, this is counted as number of wraparounds on the bus, ie 5 would mean 5 wraparounds 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00171">171</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00512">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6249520d08d6d922ac9c4f2ce86427e6"></a><!-- doxytag: member="bus.h::BUS_BROADCAST_ADDR" ref="6249520d08d6d922ac9c4f2ce86427e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_BROADCAST_ADDR&nbsp;&nbsp;&nbsp;0x00          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Bus broadcast address - All broadcast messages should contain an ID explaining which kind of device that is sending the message 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00137">137</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00128">bus_send_message()</a>, <a class="el" href="bus_8c-source.html#l00223">bus_send_nack()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00326">ISR()</a>, <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>, and <a class="el" href="front__panel_2main_8c-source.html#l00285">send_ping()</a>.</p>

</div>
</div><p>
<a class="anchor" name="f21521f2eb3f795fc45cd827290c18ff"></a><!-- doxytag: member="bus.h::BUS_DEVICE_STATUS_MESSAGE_INTERVAL" ref="f21521f2eb3f795fc45cd827290c18ff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_DEVICE_STATUS_MESSAGE_INTERVAL&nbsp;&nbsp;&nbsp;1500          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The interval between each status message (time is in ms) 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00158">158</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="driver__unit_2main_8c-source.html#l00326">ISR()</a>, and <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c6fbbe2929d0958f44d99a73f4055591"></a><!-- doxytag: member="bus.h::BUS_MASTER_SYNC_INTERVAL" ref="c6fbbe2929d0958f44d99a73f4055591" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_MASTER_SYNC_INTERVAL&nbsp;&nbsp;&nbsp;1000          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The interval which the SYNC command is sent out from the master (time in ms) This value is not allowed to be over 5000 ms since that will make it too big for the timer controlling the SYNC timeout on all the devices. 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00163">163</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="a5a11702bff91f1a9e630f6b40953f3a"></a><!-- doxytag: member="bus.h::BUS_MAX_RESENDS" ref="a5a11702bff91f1a9e630f6b40953f3a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_MAX_RESENDS&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The number of times a message is resent before it's dropped and an error flag is set 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00155">155</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00248">bus_resend_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="76bcceff22cba96905957274b8265298"></a><!-- doxytag: member="bus.h::BUS_MESSAGE_FLAGS_NEED_ACK" ref="76bcceff22cba96905957274b8265298" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_MESSAGE_FLAGS_NEED_ACK&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
BUS MESSAGE flags The message should be ACKED 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00218">218</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="antenna__ctrl_8c-source.html#l00121">antenna_ctrl_deactivate_outputs()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00139">antenna_ctrl_send_ant_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00231">antenna_ctrl_send_rx_ant_band_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00189">antenna_ctrl_send_rx_ant_data_to_bus()</a>, <a class="el" href="band__ctrl_8c-source.html#l00053">band_ctrl_send_band_data_to_bus()</a>, <a class="el" href="bus_8c-source.html#l00386">ISR()</a>, and <a class="el" href="sub__menu_8c-source.html#l00144">sub_menu_send_data_to_bus()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d5963e8d59fa0adb58ed714382363577"></a><!-- doxytag: member="bus.h::BUS_MSG_ACK" ref="d5963e8d59fa0adb58ed714382363577" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_MSG_ACK&nbsp;&nbsp;&nbsp;0xFA          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The acknowledge command of the bus 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00131">131</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="aa67432524edc62d9a071161984c8167"></a><!-- doxytag: member="bus.h::BUS_MSG_NACK" ref="aa67432524edc62d9a071161984c8167" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_MSG_NACK&nbsp;&nbsp;&nbsp;0xFB          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The NOT acknowledge command of the bus 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00133">133</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="837db7e8a269db9d24d01d5d2f20f666"></a><!-- doxytag: member="bus.h::BUS_MSG_POSTAMBLE" ref="837db7e8a269db9d24d01d5d2f20f666" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_MSG_POSTAMBLE&nbsp;&nbsp;&nbsp;0xFD          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The postamble of the BUS message 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00129">129</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00128">bus_send_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="745f0f43205404fd4fb90176db54da84"></a><!-- doxytag: member="bus.h::BUS_MSG_PREAMBLE" ref="745f0f43205404fd4fb90176db54da84" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_MSG_PREAMBLE&nbsp;&nbsp;&nbsp;0xFE          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The preamble of the BUS message 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00127">127</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00128">bus_send_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="3075ee8ff81a9a49b479684c40161fe4"></a><!-- doxytag: member="bus.h::BUS_SLOT_DEAD_TIME" ref="3075ee8ff81a9a49b479684c40161fe4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_SLOT_DEAD_TIME&nbsp;&nbsp;&nbsp;130          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The dead time of the time slot, in us. This should be set pretty high to accept rather high clock drift There is a dead period both before and after our slot, so total dead time is BUS_SLOT_DEAD_TIME * 2 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00208">208</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00078">bus_init()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ce9e759febab1ef55a06836baff54dcb"></a><!-- doxytag: member="bus.h::BUS_STATUS_ALLOWED_TO_SEND_BIT" ref="ce9e759febab1ef55a06836baff54dcb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_ALLOWED_TO_SEND_BIT&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit shows if it's allowed to send messages on the bus, ie first sync has been received 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00181">181</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="e053fff2a62fe9f1db3ade6114954f79"></a><!-- doxytag: member="bus.h::BUS_STATUS_DEVICE_IS_MASTER_BIT" ref="e053fff2a62fe9f1db3ade6114954f79" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_DEVICE_IS_MASTER_BIT&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit is to set if the device is MASTER in the bus_status.flags variable 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00179">179</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00196">bus_is_master()</a>, and <a class="el" href="bus_8c-source.html#l00206">bus_set_is_master()</a>.</p>

</div>
</div><p>
<a class="anchor" name="716f8bf40ec0a741389c83fbe7a36b25"></a><!-- doxytag: member="bus.h::BUS_STATUS_FORCE_SYNC" ref="716f8bf40ec0a741389c83fbe7a36b25" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_FORCE_SYNC&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit is to force a SYNC message to be sent 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00195">195</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00266">bus_check_tx_status()</a>, and <a class="el" href="bus_8c-source.html#l00206">bus_set_is_master()</a>.</p>

</div>
</div><p>
<a class="anchor" name="07ac20bb9da5a0d2178ade0e7e2a1055"></a><!-- doxytag: member="bus.h::BUS_STATUS_MASTER_SENT_SYNC_BIT" ref="07ac20bb9da5a0d2178ade0e7e2a1055" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_MASTER_SENT_SYNC_BIT&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit is to set if the MASTER has sent a SYNC message so we are allowed to start sending 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00185">185</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00114">bus_allowed_to_send()</a>, and <a class="el" href="bus_8c-source.html#l00386">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="079d5caf6326a9b8c706e34790c67a4d"></a><!-- doxytag: member="bus.h::BUS_STATUS_MESSAGE_ACK_TIMEOUT" ref="079d5caf6326a9b8c706e34790c67a4d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_MESSAGE_ACK_TIMEOUT&nbsp;&nbsp;&nbsp;9          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit is to see if a message should be acked or not, used for the timeout of an acknowledge 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00197">197</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00363">bus_message_acked()</a>, <a class="el" href="bus_8c-source.html#l00348">bus_message_nacked()</a>, <a class="el" href="bus_8c-source.html#l00128">bus_send_message()</a>, and <a class="el" href="bus_8c-source.html#l00512">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6a16221d27bb7882638936437408b9fa"></a><!-- doxytag: member="bus.h::BUS_STATUS_PREAMBLE_FOUND_BIT" ref="6a16221d27bb7882638936437408b9fa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_PREAMBLE_FOUND_BIT&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit is set if the preamble is found in the bus_status.flags variable 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00183">183</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

</div>
</div><p>
<a class="anchor" name="6305d4de08e065ad7a9851ee739c554c"></a><!-- doxytag: member="bus.h::BUS_STATUS_RECEIVE_ON" ref="6305d4de08e065ad7a9851ee739c554c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_RECEIVE_ON&nbsp;&nbsp;&nbsp;7          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit is to indicate that we are CURRENTLY receiving a message 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00193">193</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00078">bus_init()</a>, <a class="el" href="bus_8c-source.html#l00128">bus_send_message()</a>, and <a class="el" href="bus_8c-source.html#l00386">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="35bd108336fd649fd8e73a4e9c4a00d6"></a><!-- doxytag: member="bus.h::BUS_STATUS_SEND_ACTIVE" ref="35bd108336fd649fd8e73a4e9c4a00d6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_SEND_ACTIVE&nbsp;&nbsp;&nbsp;6          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit is to indicate that we are CURRENTLY sending a message 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00191">191</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00128">bus_send_message()</a>, and <a class="el" href="bus_8c-source.html#l00506">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ad5b06797adce7aad2eae7d9fa070bc7"></a><!-- doxytag: member="bus.h::BUS_STATUS_SEND_MESSAGE" ref="ad5b06797adce7aad2eae7d9fa070bc7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_SEND_MESSAGE&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit is to indicate that we should try to send the message currently in the TX queue 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00189">189</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00266">bus_check_tx_status()</a>, <a class="el" href="bus_8c-source.html#l00248">bus_resend_message()</a>, and <a class="el" href="bus_8c-source.html#l00175">bus_reset_tx_status()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d929cddec5866e51ae46f2b1146a3a0a"></a><!-- doxytag: member="bus.h::BUS_STATUS_TIME_SLOT_ACTIVE" ref="d929cddec5866e51ae46f2b1146a3a0a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_STATUS_TIME_SLOT_ACTIVE&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This bit is to set if the device own time slot is currently active, ie it is possibly allowed to send 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00187">187</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00266">bus_check_tx_status()</a>, and <a class="el" href="bus_8c-source.html#l00512">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8254b281c8987922cd11d6ddd74fca6a"></a><!-- doxytag: member="bus.h::BUS_SYNC_TIMEOUT_LIMIT" ref="8254b281c8987922cd11d6ddd74fca6a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_SYNC_TIMEOUT_LIMIT&nbsp;&nbsp;&nbsp;3200          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This limit is used to detect if it was too long ago since we receieved a SYNC message from the master. If so it will stop with all outgoing communication. 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00167">167</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00512">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ee2d8d588aab76ec47e5a7819b5dd99d"></a><!-- doxytag: member="bus.h::BUS_TIME_FRAME_LIMIT" ref="ee2d8d588aab76ec47e5a7819b5dd99d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_TIME_FRAME_LIMIT&nbsp;&nbsp;&nbsp;520          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The time frame size of the bus time slots, in us 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00205">205</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00078">bus_init()</a>.</p>

</div>
</div><p>
<a class="anchor" name="81e5cc7dd49cfdc283046c4c19da3423"></a><!-- doxytag: member="bus.h::BUS_TIME_INTERRUPT_INTERVAL" ref="81e5cc7dd49cfdc283046c4c19da3423" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_TIME_INTERRUPT_INTERVAL&nbsp;&nbsp;&nbsp;130          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The interval of the timer interrupts, in us 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00203">203</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00078">bus_init()</a>.</p>

</div>
</div><p>
<a class="anchor" name="550ae920e5b20b393e223b9af411d9f9"></a><!-- doxytag: member="bus.h::BUS_TIME_MULTIPLIER" ref="550ae920e5b20b393e223b9af411d9f9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_TIME_MULTIPLIER&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This is the multiplier for the send window BUS_TIME_INTERRUPT_INTERVAL * BUS_TIME_MULTIPLIER = BUS_TIME_FRAME_LIMIT 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00201">201</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00241">bus_set_device_count()</a>, <a class="el" href="bus_8c-source.html#l00206">bus_set_is_master()</a>, and <a class="el" href="bus_8c-source.html#l00386">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="01a619776878e68496fac136cae92e3b"></a><!-- doxytag: member="bus.h::BUS_TIMEOUT_LIMIT" ref="01a619776878e68496fac136cae92e3b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BUS_TIMEOUT_LIMIT&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Timeout limit for how long it can take without receiving a message before the buffer is cleared, this is counted as time, 5 would mean 5 * 130 us 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00175">175</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00512">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="14379db1c0e7d2b141c5c79b654046fa"></a><!-- doxytag: member="bus.h::DEF_NR_DEVICES" ref="14379db1c0e7d2b141c5c79b654046fa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEF_NR_DEVICES&nbsp;&nbsp;&nbsp;25          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Define the proper interrupt routines depending on hardware. 
<p>
The default number of devices 
<p>Definition at line <a class="el" href="bus_8h-source.html#l00121">121</a> of file <a class="el" href="bus_8h-source.html">bus.h</a>.</p>

<p>Referenced by <a class="el" href="bus__ping_8c-source.html#l00084">bus_ping_get_failed_count()</a>, <a class="el" href="bus__ping_8c-source.html#l00066">bus_ping_get_failed_ping()</a>, <a class="el" href="bus__ping_8c-source.html#l00027">bus_ping_init()</a>, <a class="el" href="bus__ping_8c-source.html#l00057">bus_ping_tick()</a>, and <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>.</p>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="8900b6684889df452076e67b3a528bc8"></a><!-- doxytag: member="bus.h::bus_add_rx_message" ref="8900b6684889df452076e67b3a528bc8" args="(unsigned char from_addr, unsigned char to_addr, unsigned char flags, unsigned char cmd, unsigned char length, unsigned char data[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_add_rx_message           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>from_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>to_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>data</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a message to the RX queue which will be sent as soon as possible. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>from_addr</em>&nbsp;</td><td>The address of the sender </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>to_addr</em>&nbsp;</td><td>The address to the receiever </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>Different flags, see defines </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>The command performed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the data received </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>The data receieved </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00324">324</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00234">BUS_MESSAGE::cmd</a>, <a class="el" href="bus_8h-source.html#l00238">BUS_MESSAGE::data</a>, <a class="el" href="bus_8h-source.html#l00232">BUS_MESSAGE::flags</a>, <a class="el" href="bus_8h-source.html#l00226">BUS_MESSAGE::from_addr</a>, <a class="el" href="bus_8h-source.html#l00236">BUS_MESSAGE::length</a>, <a class="el" href="bus__rx__queue_8c-source.html#l00055">rx_queue_add()</a>, and <a class="el" href="bus_8h-source.html#l00228">BUS_MESSAGE::to_addr</a>.</p>

</div>
</div><p>
<a class="anchor" name="4c78398b39ca1a317bcd94e32d3238ed"></a><!-- doxytag: member="bus.h::bus_add_tx_message" ref="4c78398b39ca1a317bcd94e32d3238ed" args="(unsigned char from_addr, unsigned char to_addr, unsigned char flags, unsigned char cmd, unsigned char length, unsigned char data[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_add_tx_message           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>from_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>to_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>data</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Adds a message to the TX queue which will be sent as soon as possible. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>from_addr</em>&nbsp;</td><td>The address of the sender </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>to_addr</em>&nbsp;</td><td>The address to the receiever </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>flags</em>&nbsp;</td><td>Different flags, see defines </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cmd</em>&nbsp;</td><td>The command wanted to be performed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>length</em>&nbsp;</td><td>The length of the data wanting to be sent </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>The data wanted to be transmitted to the receiever </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00291">291</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8c-source.html#l00114">bus_allowed_to_send()</a>, <a class="el" href="bus__commands_8h-source.html#l00035">BUS_CMD_SYNC</a>, <a class="el" href="bus_8h-source.html#l00230">BUS_MESSAGE::checksum</a>, <a class="el" href="bus_8h-source.html#l00234">BUS_MESSAGE::cmd</a>, <a class="el" href="bus_8h-source.html#l00238">BUS_MESSAGE::data</a>, <a class="el" href="bus_8h-source.html#l00232">BUS_MESSAGE::flags</a>, <a class="el" href="bus_8h-source.html#l00226">BUS_MESSAGE::from_addr</a>, <a class="el" href="bus_8h-source.html#l00236">BUS_MESSAGE::length</a>, <a class="el" href="bus_8h-source.html#l00228">BUS_MESSAGE::to_addr</a>, and <a class="el" href="bus__tx__queue_8c-source.html#l00056">tx_queue_add()</a>.</p>

<p>Referenced by <a class="el" href="antenna__ctrl_8c-source.html#l00121">antenna_ctrl_deactivate_outputs()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00139">antenna_ctrl_send_ant_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00231">antenna_ctrl_send_rx_ant_band_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00189">antenna_ctrl_send_rx_ant_data_to_bus()</a>, <a class="el" href="band__ctrl_8c-source.html#l00053">band_ctrl_send_band_data_to_bus()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00184">bus_parse_message()</a>, <a class="el" href="bus_8c-source.html#l00229">bus_send_ack()</a>, <a class="el" href="bus_8c-source.html#l00223">bus_send_nack()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00326">ISR()</a>, <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>, <a class="el" href="front__panel_2main_8c-source.html#l00285">send_ping()</a>, and <a class="el" href="sub__menu_8c-source.html#l00144">sub_menu_send_data_to_bus()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ceb215ff9ef4810ef00434c1c02f6a4c"></a><!-- doxytag: member="bus.h::bus_allowed_to_send" ref="ceb215ff9ef4810ef00434c1c02f6a4c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char bus_allowed_to_send           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns if you are allowed to transmit data to the bus or not. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>1 if it's allowed to transmit and 0 if not </dd></dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00114">114</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00185">BUS_STATUS_MASTER_SENT_SYNC_BIT</a>, and <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00291">bus_add_tx_message()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00326">ISR()</a>, and <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="978d35e07c79199b121997d80de56655"></a><!-- doxytag: member="bus.h::bus_get_address" ref="978d35e07c79199b121997d80de56655" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char bus_get_address           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns the address of this device. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The address of this device </dd></dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00123">123</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00266">bus_status_struct::ext_addr</a>.</p>

<p>Referenced by <a class="el" href="antenna__ctrl_8c-source.html#l00121">antenna_ctrl_deactivate_outputs()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00139">antenna_ctrl_send_ant_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00231">antenna_ctrl_send_rx_ant_band_data_to_bus()</a>, <a class="el" href="antenna__ctrl_8c-source.html#l00189">antenna_ctrl_send_rx_ant_data_to_bus()</a>, <a class="el" href="band__ctrl_8c-source.html#l00053">band_ctrl_send_band_data_to_bus()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00184">bus_parse_message()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00326">ISR()</a>, <a class="el" href="driver__unit_2main_8c-source.html#l00277">main()</a>, <a class="el" href="front__panel_2main_8c-source.html#l00285">send_ping()</a>, and <a class="el" href="sub__menu_8c-source.html#l00144">sub_menu_send_data_to_bus()</a>.</p>

</div>
</div><p>
<a class="anchor" name="76f9639571632344a2a1ae4138663667"></a><!-- doxytag: member="bus.h::bus_get_device_count" ref="76f9639571632344a2a1ae4138663667" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char bus_get_device_count           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Receive the device count on the bus. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The number of devices on the bus </dd></dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00235">235</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00272">bus_status_struct::device_count</a>.</p>

<p>Referenced by <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ce52a77ee7a62558643de23c5f10f9c7"></a><!-- doxytag: member="bus.h::bus_is_master" ref="ce52a77ee7a62558643de23c5f10f9c7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char bus_is_master           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns if the bus is set to be master. 
<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>1 if it is configured to be master, 0 otherwise </dd></dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00196">196</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00179">BUS_STATUS_DEVICE_IS_MASTER_BIT</a>, and <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>.</p>

<p>Referenced by <a class="el" href="front__panel_2main_8c-source.html#l00620">ISR()</a>, and <a class="el" href="driver__unit__v2_2main_8c-source.html#l00380">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="4541ef9a75addac3aaa4af88d8f03590"></a><!-- doxytag: member="bus.h::bus_message_nacked" ref="4541ef9a75addac3aaa4af88d8f03590" args="(unsigned char addr, unsigned char error_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_message_nacked           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>error_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The message last sent was NACKED from the receiver. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address of the device that sent the NACK </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>error_type</em>&nbsp;</td><td>Contains information why the message was NACKED </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00348">348</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8c-source.html#l00248">bus_resend_message()</a>, <a class="el" href="bus_8h-source.html#l00197">BUS_STATUS_MESSAGE_ACK_TIMEOUT</a>, <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>, <a class="el" href="bus_8h-source.html#l00228">BUS_MESSAGE::to_addr</a>, and <a class="el" href="bus__tx__queue_8c-source.html#l00086">tx_queue_get()</a>.</p>

<p>Referenced by <a class="el" href="driver__unit_2main_8c-source.html#l00184">bus_parse_message()</a>, and <a class="el" href="event__handler_8c-source.html#l00872">event_bus_parse_message()</a>.</p>

</div>
</div><p>
<a class="anchor" name="651be0f483dc1e17174069bbf991d653"></a><!-- doxytag: member="bus.h::bus_send_nack" ref="651be0f483dc1e17174069bbf991d653" args="(unsigned char to_addr, unsigned char error_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_send_nack           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>to_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>error_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send an NOT acknowledge. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>to_addr</em>&nbsp;</td><td>Which address we wish to send the ping to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>error_type</em>&nbsp;</td><td>Why was the message nacked, see <a class="el" href="bus_8h.html" title="The communication bus protocol used in the openASC project.">bus.h</a> for more information about BUS errors </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00223">223</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8c-source.html#l00291">bus_add_tx_message()</a>, <a class="el" href="bus_8h-source.html#l00137">BUS_BROADCAST_ADDR</a>, <a class="el" href="bus__commands_8h-source.html#l00031">BUS_CMD_NACK</a>, and <a class="el" href="bus_8h-source.html#l00266">bus_status_struct::ext_addr</a>.</p>

<p>Referenced by <a class="el" href="bus_8c-source.html#l00386">ISR()</a>.</p>

</div>
</div><p>
<a class="anchor" name="9869a6434da36c0bfa8573d68bed9b40"></a><!-- doxytag: member="bus.h::bus_set_address" ref="9869a6434da36c0bfa8573d68bed9b40" args="(unsigned char addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_set_address           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>addr</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the address of this device on the bus. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address of this device </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00108">108</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00266">bus_status_struct::ext_addr</a>.</p>

<p>Referenced by <a class="el" href="driver__unit_2main_8c-source.html#l00277">main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="bbcb4456ec66651e191189cc985bfeab"></a><!-- doxytag: member="bus.h::bus_set_device_count" ref="bbcb4456ec66651e191189cc985bfeab" args="(unsigned char device_count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_set_device_count           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>device_count</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the number of devices that are on the bus. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>device_count</em>&nbsp;</td><td>The number of devices on the bus, ie the number of time slots </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00241">241</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="bus_8h-source.html#l00201">BUS_TIME_MULTIPLIER</a>, <a class="el" href="bus_8h-source.html#l00272">bus_status_struct::device_count</a>, and <a class="el" href="bus_8h-source.html#l00274">bus_status_struct::device_count_mult</a>.</p>

</div>
</div><p>
<a class="anchor" name="ed493aabe32ac3eaafb77d4c23f15eb9"></a><!-- doxytag: member="bus.h::bus_set_is_master" ref="ed493aabe32ac3eaafb77d4c23f15eb9" args="(unsigned char state, unsigned char count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bus_set_is_master           </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Set the status if the device should be master or not. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>state</em>&nbsp;</td><td>1 if you wish the device to be master, 0 if you wish that it should be slave </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>The nr of devices </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="bus_8c-source.html#l00206">206</a> of file <a class="el" href="bus_8c-source.html">bus.c</a>.</p>

<p>References <a class="el" href="front__panel_2main_8h-source.html#l00035">BUS_STATUS_ALLOWED_TO_SEND_BIT</a>, <a class="el" href="bus_8h-source.html#l00179">BUS_STATUS_DEVICE_IS_MASTER_BIT</a>, <a class="el" href="bus_8h-source.html#l00195">BUS_STATUS_FORCE_SYNC</a>, <a class="el" href="bus_8h-source.html#l00201">BUS_TIME_MULTIPLIER</a>, <a class="el" href="bus_8h-source.html#l00272">bus_status_struct::device_count</a>, <a class="el" href="bus_8h-source.html#l00274">bus_status_struct::device_count_mult</a>, and <a class="el" href="bus_8h-source.html#l00276">bus_status_struct::flags</a>.</p>

<p>Referenced by <a class="el" href="driver__unit_2main_8c-source.html#l00277">main()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 19 20:56:58 2010 for uC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
