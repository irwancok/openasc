<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>uC: front_panel/eeprom.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>front_panel/eeprom.c</h1><a href="eeprom_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="comment">//    Copyright (C) 2008  Mikael Larsmark, SM2WMV</span>
<a name="l00009"></a>00009 <span class="comment">//</span>
<a name="l00010"></a>00010 <span class="comment">//    This program is free software: you can redistribute it and/or modify</span>
<a name="l00011"></a>00011 <span class="comment">//    it under the terms of the GNU General Public License as published by</span>
<a name="l00012"></a>00012 <span class="comment">//    the Free Software Foundation, either version 3 of the License, or</span>
<a name="l00013"></a>00013 <span class="comment">//    (at your option) any later version.</span>
<a name="l00014"></a>00014 <span class="comment">//</span>
<a name="l00015"></a>00015 <span class="comment">//    This program is distributed in the hope that it will be useful,</span>
<a name="l00016"></a>00016 <span class="comment">//    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00017"></a>00017 <span class="comment">//    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00018"></a>00018 <span class="comment">//    GNU General Public License for more details.</span>
<a name="l00019"></a>00019 <span class="comment">//</span>
<a name="l00020"></a>00020 <span class="comment">//    You should have received a copy of the GNU General Public License</span>
<a name="l00021"></a>00021 <span class="comment">//    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;avr/io.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;avr/eeprom.h&gt;</span>
<a name="l00028"></a>00028 
<a name="l00029"></a>00029 <span class="preprocessor">#include "<a class="code" href="eeprom__m24_8h.html" title="EEPROM hardware functions.">eeprom_m24.h</a>"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include "<a class="code" href="eeprom_8h.html" title="EEPROM functions.">eeprom.h</a>"</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include "../global.h"</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="antenna__ctrl_8h.html" title="Antenna control functions.">antenna_ctrl.h</a>"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="band__ctrl_8h.html" title="Band control functions.">band_ctrl.h</a>"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include "main.h"</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include "<a class="code" href="radio__interface_8h.html" title="Radio interface, such as PTT AMP, PTT Radio, CAT etc.">radio_interface.h</a>"</span>
<a name="l00036"></a>00036 
<a name="l00037"></a>00037 <span class="comment">//TODO: Fix the read block command so that reading settings from the eeprom goes faster</span>
<a name="l00038"></a>00038 
<a name="l00040"></a><a class="code" href="eeprom_8c.html#6a7acaea3ae6cfc3a2e0ad5172cff43e">00040</a> <a class="code" href="structstruct__eeprom__table.html" title="The EEPROM table.">struct_eeprom_table</a>     <a class="code" href="eeprom_8c.html#6a7acaea3ae6cfc3a2e0ad5172cff43e" title="EEPROM table which is a description of the location of different structures in the...">eeprom_table</a>;
<a name="l00041"></a>00041 
<a name="l00045"></a><a class="code" href="eeprom_8h.html#9a969c3f2bc3c4a3c78c11ce406b4d15">00045</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="eeprom_8c.html#9a969c3f2bc3c4a3c78c11ce406b4d15">eeprom_read_startup_byte</a>(<span class="keywordtype">void</span>) {
<a name="l00046"></a>00046         <span class="keywordflow">return</span>(eeprom_read_byte((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="eeprom_8h.html#45905c69e584a6a7521d710a98cd3c3e" title="Defines where the startup byte is located in the uC EEPROM. This is used to keep...">EEPROM_STARTUP_BYTE_ADDR</a>));
<a name="l00047"></a>00047 }
<a name="l00048"></a>00048 
<a name="l00051"></a><a class="code" href="eeprom_8h.html#d28f62443e97f4dc8bb5da886532d406">00051</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#d28f62443e97f4dc8bb5da886532d406" title="This function will write a byte in the EEPROM so we can keep track of if the unit...">eeprom_write_startup_byte</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> val) {
<a name="l00052"></a>00052         eeprom_write_byte((<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="eeprom_8h.html#45905c69e584a6a7521d710a98cd3c3e" title="Defines where the startup byte is located in the uC EEPROM. This is used to keep...">EEPROM_STARTUP_BYTE_ADDR</a>,val);
<a name="l00053"></a>00053 }
<a name="l00054"></a>00054 
<a name="l00056"></a><a class="code" href="eeprom_8c.html#4106e144334e369c48eed9dfe23e593c">00056</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#4106e144334e369c48eed9dfe23e593c" title="Temporary crap for debug */.">eeprom_print</a>(<span class="keywordtype">void</span>) {
<a name="l00057"></a>00057         printf(<span class="stringliteral">"ANT 1: %i\n"</span>,eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[0]);
<a name="l00058"></a>00058         printf(<span class="stringliteral">"ANT 2: %i\n"</span>,eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[1]);
<a name="l00059"></a>00059         printf(<span class="stringliteral">"ANT 3: %i\n"</span>,eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[2]);
<a name="l00060"></a>00060         printf(<span class="stringliteral">"ANT 4: %i\n"</span>,eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[3]);
<a name="l00061"></a>00061         printf(<span class="stringliteral">"ANT 5: %i\n"</span>,eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[4]);
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 
<a name="l00065"></a><a class="code" href="eeprom_8h.html#9b3f50751bd13ae358d6f6e1516c97b1">00065</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#9b3f50751bd13ae358d6f6e1516c97b1" title="Read the map of the EEPROM.">eeprom_read_table</a>(<span class="keywordtype">void</span>) {  
<a name="l00066"></a>00066         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *eeprom_table_ptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)&amp;eeprom_table;
<a name="l00067"></a>00067         
<a name="l00068"></a>00068         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(eeprom_table);i++)
<a name="l00069"></a>00069                 *(eeprom_table_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(i);
<a name="l00070"></a>00070         
<a name="l00071"></a>00071         <span class="comment">//eeprom_m24_read_block(0,sizeof(eeprom_table), (unsigned char *)&amp;eeprom_table);</span>
<a name="l00072"></a>00072 }
<a name="l00073"></a>00073 
<a name="l00077"></a><a class="code" href="eeprom_8h.html#0e660144c3c99013daacaa76a31f0ad9">00077</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#0e660144c3c99013daacaa76a31f0ad9" title="Returns the antenna struct for a specific band.">eeprom_get_antenna_data</a>(<a class="code" href="structstruct__antenna.html" title="Structure of an antenna.">struct_antenna</a> *data, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> band) {
<a name="l00078"></a>00078         <span class="comment">//Create a pointer which we can handle, and point it to where the data should be saved</span>
<a name="l00079"></a>00079         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *ant_data_ptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data;
<a name="l00080"></a>00080         
<a name="l00081"></a>00081         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__antenna.html" title="Structure of an antenna.">struct_antenna</a>);i++)
<a name="l00082"></a>00082                 *(ant_data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[band-1]+i);
<a name="l00083"></a>00083 }
<a name="l00084"></a>00084 
<a name="l00087"></a><a class="code" href="eeprom_8h.html#32589eb14b15b42f3c7c1d0dbc4278da">00087</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#32589eb14b15b42f3c7c1d0dbc4278da" title="Returns the rx antenna data.">eeprom_get_rx_antenna_data</a>(<a class="code" href="structstruct__rx__antennas.html" title="Struct which contains information of the rx antennas.">struct_rx_antennas</a> *data) {
<a name="l00088"></a>00088         <span class="comment">//Create a pointer which we can handle, and point it to where the data should be saved</span>
<a name="l00089"></a>00089         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *ant_data_ptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data;
<a name="l00090"></a>00090         
<a name="l00091"></a>00091         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__rx__antennas.html" title="Struct which contains information of the rx antennas.">struct_rx_antennas</a>);i++)
<a name="l00092"></a>00092                 *(ant_data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#1fe1fa1b9fccd59ef755085c456e8f7c" title="The start address of the RX antenna structure in the EEPROM memory.">rx_antennas</a>+i);
<a name="l00093"></a>00093 }
<a name="l00094"></a>00094 
<a name="l00098"></a><a class="code" href="eeprom_8h.html#6ec03600842aca7894be5d5e541552b6">00098</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#6ec03600842aca7894be5d5e541552b6" title="Returns the band data.">eeprom_get_band_data</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> band, <a class="code" href="structstruct__band.html" title="Struct of band data.">struct_band</a> *data) {
<a name="l00099"></a>00099         <span class="comment">//Create a pointer which we can handle, and point it to where the data should be saved</span>
<a name="l00100"></a>00100         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data_ptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data;
<a name="l00101"></a>00101         
<a name="l00102"></a>00102         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__band.html" title="Struct of band data.">struct_band</a>);i++)
<a name="l00103"></a>00103                 *(data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[band-1]+i);
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00108"></a><a class="code" href="eeprom_8h.html#317147be4ae0385bea0883aa83497e07">00108</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#317147be4ae0385bea0883aa83497e07" title="get the radio settings from the eeprom">eeprom_get_radio_settings_structure</a>(<a class="code" href="structstruct__radio__settings.html" title="Radio settings struct.">struct_radio_settings</a> *data) {
<a name="l00109"></a>00109         <span class="comment">//Create a pointer which we can handle, and point it to where the data should be saved</span>
<a name="l00110"></a>00110         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data_ptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data;
<a name="l00111"></a>00111         
<a name="l00112"></a>00112         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__radio__settings.html" title="Radio settings struct.">struct_radio_settings</a>);i++)
<a name="l00113"></a>00113                 *(data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#50e038c99a033980ff476c2f4bde86cd" title="The start address of the radio settings structure in the EEPROM memory.">radio_settings</a>+i);
<a name="l00114"></a>00114 }
<a name="l00115"></a>00115 
<a name="l00118"></a><a class="code" href="eeprom_8h.html#d24920972859f48cd9446f50986e1ee1">00118</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#d24920972859f48cd9446f50986e1ee1" title="get the settings from the eeprom">eeprom_get_settings_structure</a>(<a class="code" href="structstruct__setting.html" title="Settings struct.">struct_setting</a> *data) {
<a name="l00119"></a>00119         <span class="comment">//Create a pointer which we can handle, and point it to where the data should be saved</span>
<a name="l00120"></a>00120         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data_ptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data;
<a name="l00121"></a>00121         
<a name="l00122"></a>00122         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__setting.html" title="Settings struct.">struct_setting</a>);i++)
<a name="l00123"></a>00123                 *(data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#d4d17049af5cf3281f92993784dd8e75" title="The start address of the setting structure in the EEPROM memory.">settings</a>+i);
<a name="l00124"></a>00124 }
<a name="l00125"></a>00125 
<a name="l00127"></a><a class="code" href="eeprom_8h.html#fdf6b4f32618f74a72a10dfa15ba95f9">00127</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#fdf6b4f32618f74a72a10dfa15ba95f9" title="Creates the eeprom table which is a map over the eeprom data.">eeprom_create_table</a>(<span class="keywordtype">void</span>) {
<a name="l00128"></a>00128         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#ff26dcb858a03ffd4db8ef07e917836d" title="The size of this structure.">struct_size</a> = <span class="keyword">sizeof</span>(<a class="code" href="structstruct__eeprom__table.html" title="The EEPROM table.">struct_eeprom_table</a>);
<a name="l00129"></a>00129         
<a name="l00130"></a>00130         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[0] = 256;
<a name="l00131"></a>00131         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[1] = 768;
<a name="l00132"></a>00132         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[2] = 1280;
<a name="l00133"></a>00133         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[3] = 1792;
<a name="l00134"></a>00134         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[4] = 2304;
<a name="l00135"></a>00135         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[5] = 2816;
<a name="l00136"></a>00136         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[6] = 3328;
<a name="l00137"></a>00137         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[7] = 3840;
<a name="l00138"></a>00138         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[8] = 4352;
<a name="l00139"></a>00139                 
<a name="l00140"></a>00140         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#1fe1fa1b9fccd59ef755085c456e8f7c" title="The start address of the RX antenna structure in the EEPROM memory.">rx_antennas</a> = 4864;
<a name="l00141"></a>00141         
<a name="l00142"></a>00142         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#50e038c99a033980ff476c2f4bde86cd" title="The start address of the radio settings structure in the EEPROM memory.">radio_settings</a> = 8192;
<a name="l00143"></a>00143         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#6830b27e207021e867f63bc91ccee980" title="The start address of the sequencer.">struct_ptt</a> = 8320;
<a name="l00144"></a>00144 
<a name="l00145"></a>00145         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[0] =  8448;
<a name="l00146"></a>00146         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[1] =  8576;
<a name="l00147"></a>00147         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[2] =  8704;
<a name="l00148"></a>00148         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[3] =  8832;
<a name="l00149"></a>00149         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[4] =  8960;
<a name="l00150"></a>00150         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[5] =  9088;
<a name="l00151"></a>00151         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[6] =  9216;
<a name="l00152"></a>00152         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[7] =  9344;
<a name="l00153"></a>00153         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[8] =  9472;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#d4d17049af5cf3281f92993784dd8e75" title="The start address of the setting structure in the EEPROM memory.">settings</a> = 9600;
<a name="l00156"></a>00156         eeprom_table.<a class="code" href="structstruct__eeprom__table.html#6faadb529c3c80352df777053fccda57" title="Runtime settings, such as backlight level etc.">runtime_settings</a> = 9728;
<a name="l00157"></a>00157         
<a name="l00158"></a>00158         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> curr_addr = 9856;
<a name="l00159"></a>00159         
<a name="l00160"></a>00160         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> i=0;i&lt;9;i++) {
<a name="l00161"></a>00161                 eeprom_table.<a class="code" href="structstruct__eeprom__table.html#d64f6da74d774283ba4bc45d11b2afe7" title="The sub menus of antenna 1.">antenna1_sub_menu</a>[i] = curr_addr;
<a name="l00162"></a>00162                 curr_addr += 256;
<a name="l00163"></a>00163                 eeprom_table.<a class="code" href="structstruct__eeprom__table.html#c03bc10420fc7ae1362d9cf3b4c8b0f2" title="The sub menus of antenna 2.">antenna2_sub_menu</a>[i] = curr_addr;
<a name="l00164"></a>00164                 curr_addr += 256;
<a name="l00165"></a>00165                 eeprom_table.<a class="code" href="structstruct__eeprom__table.html#c82f9e7a98208b5901e450fff8912fac" title="The sub menus of antenna 3.">antenna3_sub_menu</a>[i] = curr_addr;
<a name="l00166"></a>00166                 curr_addr += 256;
<a name="l00167"></a>00167                 eeprom_table.<a class="code" href="structstruct__eeprom__table.html#070a7b60d374a07d456e56915fc639e3" title="The sub menus of antenna 4.">antenna4_sub_menu</a>[i] = curr_addr;
<a name="l00168"></a>00168                 curr_addr += 256;
<a name="l00169"></a>00169         }
<a name="l00170"></a>00170 
<a name="l00171"></a>00171         <span class="comment">//Save the table to the eeprom, starting from address 0</span>
<a name="l00172"></a>00172         <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(0, <span class="keyword">sizeof</span>(eeprom_table), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)&amp;eeprom_table);
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00177"></a><a class="code" href="eeprom_8h.html#e6fff39ba757b9764c196a0622c2a18d">00177</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#e6fff39ba757b9764c196a0622c2a18d" title="Save the runtime_settings structure to the eeprom.">eeprom_save_runtime_settings</a>(<a class="code" href="structstruct__runtime__settings.html" title="Settings like status but which should be saved into the EEPROM.">struct_runtime_settings</a> *content) {
<a name="l00178"></a>00178         <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#6faadb529c3c80352df777053fccda57" title="Runtime settings, such as backlight level etc.">runtime_settings</a>, <span class="keyword">sizeof</span>(<a class="code" href="structstruct__runtime__settings.html" title="Settings like status but which should be saved into the EEPROM.">struct_runtime_settings</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)content);
<a name="l00179"></a>00179 }
<a name="l00180"></a>00180 
<a name="l00183"></a><a class="code" href="eeprom_8h.html#1a16336e64981c88fed8ab3855ecd4e4">00183</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#1a16336e64981c88fed8ab3855ecd4e4" title="Get the ptt structure from the EEPROM.">eeprom_get_ptt_data</a>(<a class="code" href="structstruct__ptt.html" title="PTT Sequencer struct.">struct_ptt</a> *data) {
<a name="l00184"></a>00184         <span class="comment">//Create a pointer which we can handle, and point it to where the data should be saved</span>
<a name="l00185"></a>00185         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data_ptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data;
<a name="l00186"></a>00186         
<a name="l00187"></a>00187         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__ptt.html" title="PTT Sequencer struct.">struct_ptt</a>);i++)
<a name="l00188"></a>00188                 *(data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#6830b27e207021e867f63bc91ccee980" title="The start address of the sequencer.">struct_ptt</a>+i);
<a name="l00189"></a>00189 }
<a name="l00190"></a>00190 
<a name="l00193"></a><a class="code" href="eeprom_8h.html#65fca81181258a171926419c9d8cdd09">00193</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#65fca81181258a171926419c9d8cdd09" title="Get the runtime_settings structure from the EEPROM.">eeprom_get_runtime_settings</a>(<a class="code" href="structstruct__runtime__settings.html" title="Settings like status but which should be saved into the EEPROM.">struct_runtime_settings</a> *data) {
<a name="l00194"></a>00194         <span class="comment">//Create a pointer which we can handle, and point it to where the data should be saved</span>
<a name="l00195"></a>00195         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data_ptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data;
<a name="l00196"></a>00196         
<a name="l00197"></a>00197         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__runtime__settings.html" title="Settings like status but which should be saved into the EEPROM.">struct_runtime_settings</a>);i++)
<a name="l00198"></a>00198                 *(data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#6faadb529c3c80352df777053fccda57" title="Runtime settings, such as backlight level etc.">runtime_settings</a>+i);
<a name="l00199"></a>00199 }
<a name="l00200"></a>00200 
<a name="l00205"></a><a class="code" href="eeprom_8h.html#0b78120d991f6d5aeff7988b93f443e0">00205</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#0b78120d991f6d5aeff7988b93f443e0" title="Get the struct_sub_menu_array structure from the EEPROM.">eeprom_get_ant_sub_menu_array_structure</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> band_index, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ant_index, <a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a> *data) {
<a name="l00206"></a>00206         <span class="comment">//Create a pointer which we can handle, and point it to where the data should be saved</span>
<a name="l00207"></a>00207         <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *data_ptr = (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data;
<a name="l00208"></a>00208         
<a name="l00209"></a>00209         <span class="keywordflow">if</span> (ant_index == 0) {
<a name="l00210"></a>00210                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a>);i++)
<a name="l00211"></a>00211                         *(data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#d64f6da74d774283ba4bc45d11b2afe7" title="The sub menus of antenna 1.">antenna1_sub_menu</a>[band_index-1]+i);
<a name="l00212"></a>00212         }
<a name="l00213"></a>00213         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ant_index == 1) {
<a name="l00214"></a>00214                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a>);i++)
<a name="l00215"></a>00215                         *(data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#c03bc10420fc7ae1362d9cf3b4c8b0f2" title="The sub menus of antenna 2.">antenna2_sub_menu</a>[band_index-1]+i);
<a name="l00216"></a>00216         }
<a name="l00217"></a>00217         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ant_index == 2) {
<a name="l00218"></a>00218                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a>);i++)
<a name="l00219"></a>00219                         *(data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#c82f9e7a98208b5901e450fff8912fac" title="The sub menus of antenna 3.">antenna3_sub_menu</a>[band_index-1]+i);
<a name="l00220"></a>00220         }
<a name="l00221"></a>00221         <span class="keywordflow">else</span>    <span class="keywordflow">if</span> (ant_index == 3) {
<a name="l00222"></a>00222                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i&lt;<span class="keyword">sizeof</span>(<a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a>);i++)
<a name="l00223"></a>00223                         *(data_ptr+i) = <a class="code" href="eeprom__m24_8c.html#29035be2bd9083df1e4e23274c7a47fe" title="Read a byte of data from the EEPROM.">eeprom_m24_read_byte</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#070a7b60d374a07d456e56915fc639e3" title="The sub menus of antenna 4.">antenna4_sub_menu</a>[band_index-1]+i);
<a name="l00224"></a>00224         }
<a name="l00225"></a>00225 }
<a name="l00226"></a>00226 
<a name="l00230"></a><a class="code" href="eeprom_8h.html#dafedc1c464fc858f76bc18a5713c184">00230</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#dafedc1c464fc858f76bc18a5713c184" title="Save the antenna structure to the eeprom.">eeprom_save_ant_structure</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> band_index, <a class="code" href="structstruct__antenna.html" title="Structure of an antenna.">struct_antenna</a> *content) {
<a name="l00231"></a>00231         <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#2e3d9b78f29f5abcfbeb155d03abd383" title="The start address of the antenna structure in the EEPROM memory.">antenna</a>[band_index-1], <span class="keyword">sizeof</span>(<a class="code" href="structstruct__antenna.html" title="Structure of an antenna.">struct_antenna</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)content);
<a name="l00232"></a>00232 }
<a name="l00233"></a>00233 
<a name="l00236"></a><a class="code" href="eeprom_8h.html#055a52add142f4ef2d04ab5300136f4e">00236</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#055a52add142f4ef2d04ab5300136f4e" title="Save the rx antenna structure to the eeprom.">eeprom_save_rx_ant_structure</a>(<a class="code" href="structstruct__rx__antennas.html" title="Struct which contains information of the rx antennas.">struct_rx_antennas</a> *data) {
<a name="l00237"></a>00237         <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#1fe1fa1b9fccd59ef755085c456e8f7c" title="The start address of the RX antenna structure in the EEPROM memory.">rx_antennas</a>, <span class="keyword">sizeof</span>(<a class="code" href="structstruct__rx__antennas.html" title="Struct which contains information of the rx antennas.">struct_rx_antennas</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data);
<a name="l00238"></a>00238 }
<a name="l00239"></a>00239 
<a name="l00242"></a><a class="code" href="eeprom_8h.html#1d9de145325f4507c363219ec79bdab0">00242</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#1d9de145325f4507c363219ec79bdab0" title="Save the device settings to the eeprom.">eeprom_save_settings_structure</a>(<a class="code" href="structstruct__setting.html" title="Settings struct.">struct_setting</a> *data) {
<a name="l00243"></a>00243         <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#d4d17049af5cf3281f92993784dd8e75" title="The start address of the setting structure in the EEPROM memory.">settings</a>, <span class="keyword">sizeof</span>(<a class="code" href="structstruct__setting.html" title="Settings struct.">struct_setting</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data);
<a name="l00244"></a>00244 }
<a name="l00245"></a>00245 
<a name="l00248"></a><a class="code" href="eeprom_8h.html#b943872b90370fbb808bf2f6933f0b1e">00248</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#b943872b90370fbb808bf2f6933f0b1e" title="Save the radio settings to the eeprom.">eeprom_save_radio_settings_structure</a>(<a class="code" href="structstruct__radio__settings.html" title="Radio settings struct.">struct_radio_settings</a> *data) {
<a name="l00249"></a>00249         <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#50e038c99a033980ff476c2f4bde86cd" title="The start address of the radio settings structure in the EEPROM memory.">radio_settings</a>, <span class="keyword">sizeof</span>(<a class="code" href="structstruct__radio__settings.html" title="Radio settings struct.">struct_radio_settings</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data);
<a name="l00250"></a>00250 }
<a name="l00251"></a>00251 
<a name="l00255"></a><a class="code" href="eeprom_8h.html#64e5d1bd12072950491e44547610bd97">00255</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#64e5d1bd12072950491e44547610bd97" title="Save the band data to the eeprom.">eeprom_save_band_data</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> band, <a class="code" href="structstruct__band.html" title="Struct of band data.">struct_band</a> *data) {
<a name="l00256"></a>00256         <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#969c52f2bed0d41c06a2eba0d635858d" title="The start address of the band structure in the EEPROM memory.">band</a>[band-1], <span class="keyword">sizeof</span>(<a class="code" href="structstruct__band.html" title="Struct of band data.">struct_band</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data);
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00261"></a><a class="code" href="eeprom_8h.html#2c96a61dec288a4385e46df909c370ab">00261</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#2c96a61dec288a4385e46df909c370ab" title="Save the band data to the eeprom.">eeprom_save_ptt_data</a>(<a class="code" href="structstruct__ptt.html" title="PTT Sequencer struct.">struct_ptt</a> *data) {
<a name="l00262"></a>00262         <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#6830b27e207021e867f63bc91ccee980" title="The start address of the sequencer.">struct_ptt</a>, <span class="keyword">sizeof</span>(<a class="code" href="structstruct__ptt.html" title="PTT Sequencer struct.">struct_ptt</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data);
<a name="l00263"></a>00263 }
<a name="l00264"></a>00264 
<a name="l00269"></a><a class="code" href="eeprom_8h.html#f39ecd57ed4a610641ab16023bab3375">00269</a> <span class="keywordtype">void</span> <a class="code" href="eeprom_8c.html#f39ecd57ed4a610641ab16023bab3375" title="Save the sub menu array data to the EEPROM.">eeprom_save_ant_sub_menu_array_structure</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> band_index, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> ant_index, <a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a> *data) {
<a name="l00270"></a>00270         <span class="keywordflow">if</span> (ant_index == 0)
<a name="l00271"></a>00271                 <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#d64f6da74d774283ba4bc45d11b2afe7" title="The sub menus of antenna 1.">antenna1_sub_menu</a>[band_index-1], <span class="keyword">sizeof</span>(<a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data);
<a name="l00272"></a>00272         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ant_index == 1)
<a name="l00273"></a>00273                 <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#c03bc10420fc7ae1362d9cf3b4c8b0f2" title="The sub menus of antenna 2.">antenna2_sub_menu</a>[band_index-1], <span class="keyword">sizeof</span>(<a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data);
<a name="l00274"></a>00274         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ant_index == 2)
<a name="l00275"></a>00275                 <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#c82f9e7a98208b5901e450fff8912fac" title="The sub menus of antenna 3.">antenna3_sub_menu</a>[band_index-1], <span class="keyword">sizeof</span>(<a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data);
<a name="l00276"></a>00276         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ant_index == 3)
<a name="l00277"></a>00277                 <a class="code" href="eeprom__m24_8c.html#0fb1100de5afaa4fec8cd5337a7f1db8" title="Write a block of data to the EEPROM.">eeprom_m24_write_block</a>(eeprom_table.<a class="code" href="structstruct__eeprom__table.html#070a7b60d374a07d456e56915fc639e3" title="The sub menus of antenna 4.">antenna4_sub_menu</a>[band_index-1], <span class="keyword">sizeof</span>(<a class="code" href="structstruct__sub__menu__array.html" title="Struct of a sub menu with the type array.">struct_sub_menu_array</a>), (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)data);
<a name="l00278"></a>00278 }
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 19 20:56:57 2010 for uC by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
